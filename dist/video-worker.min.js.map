{"version":3,"file":"video-worker.min.js","sources":["../src/defaults.js","../src/base-class.js","../src/utils/global.js","../src/utils/extend.js","../src/utils/deferred.js","../src/providers/youtube.js","../src/providers/vimeo.js","../src/video-worker.js","../src/providers/local.js"],"sourcesContent":["export default {\n  autoplay: false,\n  loop: false,\n  mute: false,\n  volume: 100,\n  showControls: true,\n  accessibilityHidden: false,\n\n  // start / end video time in seconds\n  startTime: 0,\n  endTime: 0,\n};\n","import defaults from './defaults';\nimport extend from './utils/extend';\n\nlet ID = 0;\n\nclass VideoWorkerBase {\n  type = 'none';\n\n  constructor(url, options) {\n    const self = this;\n\n    self.url = url;\n\n    self.options_default = { ...defaults };\n\n    self.options = extend({}, self.options_default, options);\n\n    // check URL\n    self.videoID = self.constructor.parseURL(url);\n\n    // init\n    if (self.videoID) {\n      self.init();\n    }\n  }\n\n  isValid() {\n    return !!this.videoID;\n  }\n\n  init() {\n    const self = this;\n\n    self.ID = ID;\n    ID += 1;\n\n    self.playerID = `VideoWorker-${self.ID}`;\n  }\n\n  // events\n  on(name, callback) {\n    this.userEventsList = this.userEventsList || [];\n\n    // add new callback in events list\n    (this.userEventsList[name] || (this.userEventsList[name] = [])).push(callback);\n  }\n\n  off(name, callback) {\n    if (!this.userEventsList || !this.userEventsList[name]) {\n      return;\n    }\n\n    if (!callback) {\n      delete this.userEventsList[name];\n    } else {\n      this.userEventsList[name].forEach((val, key) => {\n        if (val === callback) {\n          this.userEventsList[name][key] = false;\n        }\n      });\n    }\n  }\n\n  fire(name, ...args) {\n    if (this.userEventsList && typeof this.userEventsList[name] !== 'undefined') {\n      this.userEventsList[name].forEach((val) => {\n        // call with all arguments\n        if (val) {\n          val.apply(this, args);\n        }\n      });\n    }\n  }\n\n  /**\n   * Methods used in providers.\n   */\n  /* eslint-disable */\n  static parseURL(url) {\n    return false;\n  }\n  play(start) {}\n  pause() {}\n  mute() {}\n  unmute() {}\n  setVolume(volume = false) {}\n  getVolume(callback) {}\n  getMuted(callback) {}\n  setCurrentTime(currentTime = false) {}\n  getCurrentTime(callback) {}\n  getImageURL(callback) {}\n  getVideo(callback) {}\n  /* eslint-enable */\n}\n\nexport default VideoWorkerBase;\n","/* eslint-disable import/no-mutable-exports */\n/* eslint-disable no-restricted-globals */\nlet win;\n\nif (typeof window !== 'undefined') {\n  win = window;\n} else if (typeof global !== 'undefined') {\n  win = global;\n} else if (typeof self !== 'undefined') {\n  win = self;\n} else {\n  win = {};\n}\n\nexport default win;\n","/**\n * Extend like jQuery.extend\n *\n * @param {Object} out - output object.\n * @param {...any} args - additional objects to extend.\n *\n * @returns {Object}\n */\nexport default function extend(out, ...args) {\n  out = out || {};\n\n  Object.keys(args).forEach((i) => {\n    if (!args[i]) {\n      return;\n    }\n    Object.keys(args[i]).forEach((key) => {\n      out[key] = args[i][key];\n    });\n  });\n\n  return out;\n}\n","// Deferred\n// thanks http://stackoverflow.com/questions/18096715/implement-deferred-object-without-using-jquery\nfunction Deferred() {\n  this.doneCallbacks = [];\n  this.failCallbacks = [];\n}\n\nDeferred.prototype = {\n  execute(list, args) {\n    let i = list.length;\n    // eslint-disable-next-line no-param-reassign\n    args = Array.prototype.slice.call(args);\n\n    while (i) {\n      i -= 1;\n      list[i].apply(null, args);\n    }\n  },\n  resolve(...args) {\n    this.execute(this.doneCallbacks, args);\n  },\n  reject(...args) {\n    this.execute(this.failCallbacks, args);\n  },\n  done(callback) {\n    this.doneCallbacks.push(callback);\n  },\n  fail(callback) {\n    this.failCallbacks.push(callback);\n  },\n};\n\nexport default Deferred;\n","import BaseClass from '../base-class';\nimport global from '../utils/global';\nimport Deferred from '../utils/deferred';\n\nlet YoutubeAPIadded = 0;\nlet loadingYoutubePlayer = 0;\nconst loadingYoutubeDefer = new Deferred();\n\nfunction loadAPI() {\n  if (YoutubeAPIadded) {\n    return;\n  }\n\n  YoutubeAPIadded = true;\n\n  const src = 'https://www.youtube.com/iframe_api';\n\n  if (!src) {\n    return;\n  }\n\n  // add script in head section\n  let tag = document.createElement('script');\n  let head = document.getElementsByTagName('head')[0];\n  tag.src = src;\n\n  head.appendChild(tag);\n\n  head = null;\n  tag = null;\n}\n\nfunction onAPIready(callback) {\n  // Listen for global YT player callback\n  if ((typeof global.YT === 'undefined' || global.YT.loaded === 0) && !loadingYoutubePlayer) {\n    // Prevents Ready event from being called twice\n    loadingYoutubePlayer = 1;\n\n    // Creates deferred so, other players know when to wait.\n    global.onYouTubeIframeAPIReady = function () {\n      global.onYouTubeIframeAPIReady = null;\n      loadingYoutubeDefer.resolve('done');\n      callback();\n    };\n  } else if (typeof global.YT === 'object' && global.YT.loaded === 1) {\n    callback();\n  } else {\n    loadingYoutubeDefer.done(() => {\n      callback();\n    });\n  }\n}\n\nclass VideoWorkerYoutube extends BaseClass {\n  type = 'youtube';\n\n  static parseURL(url) {\n    // eslint-disable-next-line no-useless-escape\n    const regExp = /.*(?:youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|shorts\\/|watch\\?v=)([^#\\&\\?]*).*/;\n    const match = url.match(regExp);\n    return match && match[1].length === 11 ? match[1] : false;\n  }\n\n  init() {\n    super.init();\n\n    loadAPI();\n  }\n\n  play(start) {\n    const self = this;\n    if (!self.player || !self.player.playVideo) {\n      return;\n    }\n\n    if (typeof start !== 'undefined') {\n      self.player.seekTo(start || 0);\n    }\n\n    if (global.YT.PlayerState.PLAYING !== self.player.getPlayerState()) {\n      // Don't play if video is already ended and with no loop.\n      if (self.options.endTime && !self.options.loop) {\n        self.getCurrentTime((seconds) => {\n          if (seconds < self.options.endTime) {\n            self.player.playVideo();\n          }\n        });\n      } else {\n        self.player.playVideo();\n      }\n    }\n  }\n\n  pause() {\n    const self = this;\n    if (!self.player || !self.player.pauseVideo) {\n      return;\n    }\n\n    if (global.YT.PlayerState.PLAYING === self.player.getPlayerState()) {\n      self.player.pauseVideo();\n    }\n  }\n\n  mute() {\n    const self = this;\n    if (!self.player || !self.player.mute) {\n      return;\n    }\n\n    self.player.mute();\n  }\n\n  unmute() {\n    const self = this;\n    if (!self.player || !self.player.unMute) {\n      return;\n    }\n\n    self.player.unMute();\n  }\n\n  setVolume(volume = false) {\n    const self = this;\n    if (!self.player || typeof volume !== 'number' || !self.player.setVolume) {\n      return;\n    }\n\n    self.player.setVolume(volume);\n  }\n\n  getVolume(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(false);\n      return;\n    }\n\n    if (self.player.getVolume) {\n      callback(self.player.getVolume());\n    }\n  }\n\n  getMuted(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(null);\n      return;\n    }\n\n    if (self.player.isMuted) {\n      callback(self.player.isMuted());\n    }\n  }\n\n  setCurrentTime(currentTime = false) {\n    const self = this;\n    if (!self.player || typeof currentTime !== 'number' || !self.player.seekTo) {\n      return;\n    }\n\n    self.player.seekTo(currentTime);\n  }\n\n  getCurrentTime(callback) {\n    const self = this;\n    if (!self.player || !self.player.getCurrentTime) {\n      return;\n    }\n\n    callback(self.player.getCurrentTime());\n  }\n\n  getImageURL(callback) {\n    const self = this;\n\n    if (self.videoImage) {\n      callback(self.videoImage);\n      return;\n    }\n\n    const availableSizes = ['maxresdefault', 'sddefault', 'hqdefault', '0'];\n    let step = 0;\n\n    const tempImg = new Image();\n    tempImg.onload = function () {\n      // if no thumbnail, youtube add their own image with width = 120px\n      if ((this.naturalWidth || this.width) !== 120 || step === availableSizes.length - 1) {\n        // ok\n        self.videoImage = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n        callback(self.videoImage);\n      } else {\n        // try another size\n        step += 1;\n        this.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n      }\n    };\n    tempImg.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n  }\n\n  getVideo(callback) {\n    const self = this;\n\n    // return generated video block\n    if (self.$video) {\n      callback(self.$video);\n      return;\n    }\n\n    // generate new video block\n    onAPIready(() => {\n      let hiddenDiv;\n      if (!self.$video) {\n        hiddenDiv = document.createElement('div');\n        hiddenDiv.style.display = 'none';\n      }\n\n      self.playerOptions = {\n        // GDPR Compliance.\n        host: 'https://www.youtube-nocookie.com',\n        videoId: self.videoID,\n        playerVars: {\n          autohide: 1,\n          rel: 0,\n          autoplay: 0,\n          // autoplay enable on mobile devices\n          playsinline: 1,\n        },\n      };\n\n      // hide controls\n      if (!self.options.showControls) {\n        self.playerOptions.playerVars.iv_load_policy = 3;\n        self.playerOptions.playerVars.modestbranding = 1;\n        self.playerOptions.playerVars.controls = 0;\n        self.playerOptions.playerVars.showinfo = 0;\n        self.playerOptions.playerVars.disablekb = 1;\n      }\n\n      // events\n      let ytStarted;\n      let ytProgressInterval;\n      self.playerOptions.events = {\n        onReady(e) {\n          // mute\n          if (self.options.mute) {\n            e.target.mute();\n          } else if (typeof self.options.volume === 'number') {\n            e.target.setVolume(self.options.volume);\n          }\n\n          // autoplay\n          if (self.options.autoplay) {\n            self.play(self.options.startTime);\n          }\n          self.fire('ready', e);\n\n          // For seamless loops, set the endTime to 0.1 seconds less than the video's duration\n          // https://github.com/nk-o/video-worker/issues/2\n          if (self.options.loop && !self.options.endTime) {\n            const secondsOffset = 0.1;\n            self.options.endTime = self.player.getDuration() - secondsOffset;\n          }\n\n          // volumechange\n          setInterval(() => {\n            self.getVolume((volume) => {\n              if (self.options.volume !== volume) {\n                self.options.volume = volume;\n                self.fire('volumechange', e);\n              }\n            });\n          }, 150);\n        },\n        onStateChange(e) {\n          // loop\n          if (self.options.loop && e.data === global.YT.PlayerState.ENDED) {\n            self.play(self.options.startTime);\n          }\n          if (!ytStarted && e.data === global.YT.PlayerState.PLAYING) {\n            ytStarted = 1;\n            self.fire('started', e);\n          }\n          if (e.data === global.YT.PlayerState.PLAYING) {\n            self.fire('play', e);\n          }\n          if (e.data === global.YT.PlayerState.PAUSED) {\n            self.fire('pause', e);\n          }\n          if (e.data === global.YT.PlayerState.ENDED) {\n            self.fire('ended', e);\n          }\n\n          // progress check\n          if (e.data === global.YT.PlayerState.PLAYING) {\n            ytProgressInterval = setInterval(() => {\n              self.fire('timeupdate', e);\n\n              // check for end of video and play again or stop\n              if (self.options.endTime && self.player.getCurrentTime() >= self.options.endTime) {\n                if (self.options.loop) {\n                  self.play(self.options.startTime);\n                } else {\n                  self.pause();\n                }\n              }\n            }, 150);\n          } else {\n            clearInterval(ytProgressInterval);\n          }\n        },\n        onError(e) {\n          self.fire('error', e);\n        },\n      };\n\n      const firstInit = !self.$video;\n      if (firstInit) {\n        const div = document.createElement('div');\n        div.setAttribute('id', self.playerID);\n        hiddenDiv.appendChild(div);\n        document.body.appendChild(hiddenDiv);\n      }\n      self.player = self.player || new global.YT.Player(self.playerID, self.playerOptions);\n      if (firstInit) {\n        self.$video = document.getElementById(self.playerID);\n\n        // add accessibility attributes\n        if (self.options.accessibilityHidden) {\n          self.$video.setAttribute('tabindex', '-1');\n          self.$video.setAttribute('aria-hidden', 'true');\n        }\n\n        // get video width and height\n        self.videoWidth = parseInt(self.$video.getAttribute('width'), 10) || 1280;\n        self.videoHeight = parseInt(self.$video.getAttribute('height'), 10) || 720;\n      }\n\n      callback(self.$video);\n    });\n  }\n}\n\nexport default VideoWorkerYoutube;\n","import BaseClass from '../base-class';\nimport global from '../utils/global';\nimport Deferred from '../utils/deferred';\n\nlet VimeoAPIadded = 0;\nlet loadingVimeoPlayer = 0;\nconst loadingVimeoDefer = new Deferred();\n\nfunction loadAPI() {\n  if (VimeoAPIadded) {\n    return;\n  }\n\n  VimeoAPIadded = true;\n\n  // Useful when Vimeo API added using RequireJS https://github.com/nk-o/video-worker/pull/7\n  if (typeof global.Vimeo !== 'undefined') {\n    return;\n  }\n\n  const src = 'https://player.vimeo.com/api/player.js';\n\n  // add script in head section\n  let tag = document.createElement('script');\n  let head = document.getElementsByTagName('head')[0];\n  tag.src = src;\n\n  head.appendChild(tag);\n\n  head = null;\n  tag = null;\n}\n\nfunction onAPIready(callback) {\n  if (typeof global.Vimeo === 'undefined' && !loadingVimeoPlayer) {\n    loadingVimeoPlayer = 1;\n    const vimeoInterval = setInterval(() => {\n      if (typeof global.Vimeo !== 'undefined') {\n        clearInterval(vimeoInterval);\n        loadingVimeoDefer.resolve('done');\n        callback();\n      }\n    }, 20);\n  } else if (typeof global.Vimeo !== 'undefined') {\n    callback();\n  } else {\n    loadingVimeoDefer.done(() => {\n      callback();\n    });\n  }\n}\n\nclass VideoWorkerVimeo extends BaseClass {\n  type = 'vimeo';\n\n  static parseURL(url) {\n    // eslint-disable-next-line no-useless-escape\n    const regExp =\n      /https?:\\/\\/(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/([^/]*)\\/videos\\/|album\\/(\\d+)\\/video\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/;\n    const match = url.match(regExp);\n    return match && match[3] ? match[3] : false;\n  }\n\n  // Try to extract a hash for private videos from the URL.\n  // Thanks to https://github.com/sampotts/plyr\n  static parseURLHash(url) {\n    /* This regex matches a hexadecimal hash if given in any of these forms:\n     *  - [https://player.]vimeo.com/video/{id}/{hash}[?params]\n     *  - [https://player.]vimeo.com/video/{id}?h={hash}[&params]\n     *  - [https://player.]vimeo.com/video/{id}?[params]&h={hash}\n     *  - video/{id}/{hash}\n     * If matched, the hash is available in capture group 4\n     */\n    const regex = /^.*(vimeo.com\\/|video\\/)(\\d+)(\\?.*&*h=|\\/)+([\\d,a-f]+)/;\n    const found = url.match(regex);\n\n    return found && found.length === 5 ? found[4] : null;\n  }\n\n  init() {\n    super.init();\n\n    loadAPI();\n  }\n\n  play(start) {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (typeof start !== 'undefined') {\n      self.player.setCurrentTime(start);\n    }\n\n    self.player.getPaused().then((paused) => {\n      if (paused) {\n        // Don't play if video is already ended and with no loop.\n        if (self.options.endTime && !self.options.loop) {\n          self.getCurrentTime((seconds) => {\n            if (seconds < self.options.endTime) {\n              self.player.play();\n            }\n          });\n        } else {\n          self.player.play();\n        }\n      }\n    });\n  }\n\n  pause() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    self.player.getPaused().then((paused) => {\n      if (!paused) {\n        self.player.pause();\n      }\n    });\n  }\n\n  mute() {\n    const self = this;\n    if (!self.player || !self.player.setVolume) {\n      return;\n    }\n\n    self.setVolume(0);\n  }\n\n  unmute() {\n    const self = this;\n    if (!self.player || !self.player.setVolume) {\n      return;\n    }\n\n    // In case the default volume is 0, we have to set 100 when unmute.\n    self.setVolume(self.options.volume || 100);\n  }\n\n  setVolume(volume = false) {\n    const self = this;\n    if (!self.player || typeof volume !== 'number' || !self.player.setVolume) {\n      return;\n    }\n\n    self.player.setVolume(volume / 100);\n  }\n\n  getVolume(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(false);\n      return;\n    }\n\n    if (self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(volume * 100);\n      });\n    }\n  }\n\n  getMuted(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(null);\n      return;\n    }\n\n    if (self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(!!volume);\n      });\n    }\n  }\n\n  setCurrentTime(currentTime = false) {\n    const self = this;\n    if (!self.player || typeof currentTime !== 'number' || !self.player.setCurrentTime) {\n      return;\n    }\n\n    self.player.setCurrentTime(currentTime);\n  }\n\n  getCurrentTime(callback) {\n    const self = this;\n    if (!self.player || !self.player.getCurrentTime) {\n      return;\n    }\n\n    self.player.getCurrentTime().then((currentTime) => {\n      callback(currentTime);\n    });\n  }\n\n  getImageURL(callback) {\n    const self = this;\n\n    if (self.videoImage) {\n      callback(self.videoImage);\n      return;\n    }\n\n    // We should provide width to get HQ thumbnail URL.\n    let width = global.innerWidth || 1920;\n    if (global.devicePixelRatio) {\n      width *= global.devicePixelRatio;\n    }\n    width = Math.min(width, 1920);\n\n    let request = new XMLHttpRequest();\n    // https://vimeo.com/api/oembed.json?url=https://vimeo.com/235212527\n    request.open('GET', `https://vimeo.com/api/oembed.json?url=${self.url}&width=${width}`, true);\n    request.onreadystatechange = function () {\n      if (this.readyState === 4) {\n        if (this.status >= 200 && this.status < 400) {\n          // Success!\n          const response = JSON.parse(this.responseText);\n\n          if (response.thumbnail_url) {\n            self.videoImage = response.thumbnail_url;\n            callback(self.videoImage);\n          }\n        } else {\n          // Error :(\n        }\n      }\n    };\n    request.send();\n    request = null;\n  }\n\n  getVideo(callback) {\n    const self = this;\n\n    // return generated video block\n    if (self.$video) {\n      callback(self.$video);\n      return;\n    }\n\n    // generate new video block\n    onAPIready(() => {\n      let hiddenDiv;\n      if (!self.$video) {\n        hiddenDiv = document.createElement('div');\n        hiddenDiv.style.display = 'none';\n      }\n\n      self.playerOptions = {\n        // GDPR Compliance.\n        dnt: 1,\n        id: self.videoID,\n        autopause: 0,\n        transparent: 0,\n        autoplay: self.options.autoplay ? 1 : 0,\n        loop: self.options.loop ? 1 : 0,\n        muted: self.options.mute || self.options.volume === 0 ? 1 : 0,\n      };\n\n      // private video hash\n      const urlHash = self.constructor.parseURLHash(self.url);\n      if (urlHash) {\n        self.playerOptions.h = urlHash;\n      }\n\n      // hide controls\n      if (!self.options.showControls) {\n        self.playerOptions.controls = 0;\n      }\n\n      // enable background option\n      if (!self.options.showControls && self.options.loop && self.options.autoplay) {\n        self.playerOptions.background = 1;\n      }\n\n      if (!self.$video) {\n        let playerOptionsString = '';\n        Object.keys(self.playerOptions).forEach((key) => {\n          if (playerOptionsString !== '') {\n            playerOptionsString += '&';\n          }\n          playerOptionsString += `${key}=${encodeURIComponent(self.playerOptions[key])}`;\n        });\n\n        // we need to create iframe manually because when we create it using API\n        // js events won't triggers after iframe moved to another place\n        self.$video = document.createElement('iframe');\n        self.$video.setAttribute('id', self.playerID);\n        self.$video.setAttribute(\n          'src',\n          `https://player.vimeo.com/video/${self.videoID}?${playerOptionsString}`\n        );\n        self.$video.setAttribute('frameborder', '0');\n        self.$video.setAttribute('mozallowfullscreen', '');\n        self.$video.setAttribute('allowfullscreen', '');\n        self.$video.setAttribute('title', 'Vimeo video player');\n\n        // add accessibility attributes\n        if (self.options.accessibilityHidden) {\n          self.$video.setAttribute('tabindex', '-1');\n          self.$video.setAttribute('aria-hidden', 'true');\n        }\n\n        hiddenDiv.appendChild(self.$video);\n        document.body.appendChild(hiddenDiv);\n      }\n      self.player = self.player || new global.Vimeo.Player(self.$video, self.playerOptions);\n\n      // Since Vimeo removed the `volume` parameter, we have to set it manually.\n      if (!self.options.mute && typeof self.options.volume === 'number') {\n        self.setVolume(self.options.volume);\n      }\n\n      // set current time for autoplay\n      if (self.options.startTime && self.options.autoplay) {\n        self.player.setCurrentTime(self.options.startTime);\n      }\n\n      // get video width and height\n      self.player.getVideoWidth().then((width) => {\n        self.videoWidth = width || 1280;\n      });\n      self.player.getVideoHeight().then((height) => {\n        self.videoHeight = height || 720;\n      });\n\n      // events\n      let vmStarted;\n      self.player.on('timeupdate', (e) => {\n        if (!vmStarted) {\n          self.fire('started', e);\n          vmStarted = 1;\n        }\n\n        self.fire('timeupdate', e);\n\n        // check for end of video and play again or stop\n        if (self.options.endTime && e.seconds >= self.options.endTime) {\n          if (self.options.loop) {\n            self.play(self.options.startTime);\n          } else {\n            self.pause();\n          }\n        }\n      });\n      self.player.on('play', (e) => {\n        self.fire('play', e);\n\n        // check for the start time and start with it\n        if (self.options.startTime && e.seconds === 0) {\n          self.play(self.options.startTime);\n        }\n      });\n      self.player.on('pause', (e) => {\n        self.fire('pause', e);\n      });\n      self.player.on('ended', (e) => {\n        self.fire('ended', e);\n      });\n      self.player.on('loaded', (e) => {\n        self.fire('ready', e);\n      });\n      self.player.on('volumechange', (e) => {\n        self.getVolume((volume) => {\n          self.options.volume = volume;\n        });\n        self.fire('volumechange', e);\n      });\n      self.player.on('error', (e) => {\n        self.fire('error', e);\n      });\n\n      callback(self.$video);\n    });\n  }\n}\n\nexport default VideoWorkerVimeo;\n","import VideoWorkerBase from './base-class';\nimport VideoWorkerYoutube from './providers/youtube';\nimport VideoWorkerVimeo from './providers/vimeo';\nimport VideoWorkerLocal from './providers/local';\n\nfunction VideoWorker(url, options) {\n  let result = false;\n\n  Object.keys(VideoWorker.providers).forEach((key) => {\n    if (!result && VideoWorker.providers[key].parseURL(url)) {\n      result = new VideoWorker.providers[key](url, options);\n    }\n  });\n\n  return result || new VideoWorkerBase(url, options);\n}\n\nVideoWorker.BaseClass = VideoWorkerBase;\nVideoWorker.providers = {\n  Youtube: VideoWorkerYoutube,\n  Vimeo: VideoWorkerVimeo,\n  Local: VideoWorkerLocal,\n};\n\nexport default VideoWorker;\n","import BaseClass from '../base-class';\n\nclass VideoWorkerLocal extends BaseClass {\n  type = 'local';\n\n  static parseURL(url) {\n    // eslint-disable-next-line no-useless-escape\n    const videoFormats = url.split(/,(?=mp4\\:|webm\\:|ogv\\:|ogg\\:)/);\n    const result = {};\n    let ready = 0;\n\n    videoFormats.forEach((val) => {\n      // eslint-disable-next-line no-useless-escape\n      const match = val.match(/^(mp4|webm|ogv|ogg)\\:(.*)/);\n      if (match && match[1] && match[2]) {\n        // eslint-disable-next-line prefer-destructuring\n        result[match[1] === 'ogv' ? 'ogg' : match[1]] = match[2];\n        ready = 1;\n      }\n    });\n\n    return ready ? result : false;\n  }\n\n  play(start) {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (typeof start !== 'undefined') {\n      self.player.currentTime = start;\n    }\n\n    if (self.player.paused) {\n      // Don't play if video is already ended and with no loop.\n      if (self.options.endTime && !self.options.loop) {\n        self.getCurrentTime((seconds) => {\n          if (seconds < self.options.endTime) {\n            self.player.play();\n          }\n        });\n      } else {\n        self.player.play();\n      }\n    }\n  }\n\n  pause() {\n    const self = this;\n    if (!self.player || self.player.paused) {\n      return;\n    }\n\n    self.player.pause();\n  }\n\n  mute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    self.$video.muted = true;\n  }\n\n  unmute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    self.$video.muted = false;\n  }\n\n  setVolume(volume = false) {\n    const self = this;\n    if (!self.player || typeof volume !== 'number') {\n      return;\n    }\n\n    self.$video.volume = volume / 100;\n  }\n\n  getVolume(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(false);\n      return;\n    }\n\n    callback(self.$video.volume * 100);\n  }\n\n  getMuted(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(null);\n      return;\n    }\n\n    callback(self.$video.muted);\n  }\n\n  setCurrentTime(currentTime = false) {\n    const self = this;\n    if (!self.player || typeof currentTime !== 'number') {\n      return;\n    }\n\n    self.$video.currentTime = currentTime;\n  }\n\n  getCurrentTime(callback) {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    callback(self.player.currentTime);\n  }\n\n  getImageURL(callback) {\n    const self = this;\n\n    if (self.videoImage) {\n      callback(self.videoImage);\n    }\n  }\n\n  getVideo(callback) {\n    const self = this;\n\n    // return generated video block\n    if (self.$video) {\n      callback(self.$video);\n      return;\n    }\n\n    // generate new video block\n    let hiddenDiv;\n    if (!self.$video) {\n      hiddenDiv = document.createElement('div');\n      hiddenDiv.style.display = 'none';\n    }\n\n    function addSourceElement(element, src, type) {\n      const source = document.createElement('source');\n      source.src = src;\n      source.type = type;\n      element.appendChild(source);\n    }\n\n    if (!self.$video) {\n      self.$video = document.createElement('video');\n      self.player = self.$video;\n\n      // show controls\n      if (self.options.showControls) {\n        self.$video.controls = true;\n      }\n\n      // set volume\n      if (typeof self.options.volume === 'number') {\n        self.setVolume(self.options.volume);\n      }\n\n      // mute (it is required to mute after the volume set)\n      if (self.options.mute) {\n        self.mute();\n      }\n\n      // loop\n      if (self.options.loop) {\n        self.$video.loop = true;\n      }\n\n      // autoplay enable on mobile devices\n      self.$video.setAttribute('playsinline', '');\n      self.$video.setAttribute('webkit-playsinline', '');\n\n      // add accessibility attributes\n      if (self.options.accessibilityHidden) {\n        self.$video.setAttribute('tabindex', '-1');\n        self.$video.setAttribute('aria-hidden', 'true');\n      }\n\n      self.$video.setAttribute('id', self.playerID);\n      hiddenDiv.appendChild(self.$video);\n      document.body.appendChild(hiddenDiv);\n\n      Object.keys(self.videoID).forEach((key) => {\n        addSourceElement(self.$video, self.videoID[key], `video/${key}`);\n      });\n    }\n\n    let locStarted;\n    self.player.addEventListener('playing', (e) => {\n      if (!locStarted) {\n        self.fire('started', e);\n      }\n      locStarted = 1;\n    });\n    self.player.addEventListener('timeupdate', function (e) {\n      self.fire('timeupdate', e);\n\n      // check for end of video and play again or stop\n      if (self.options.endTime && this.currentTime >= self.options.endTime) {\n        if (self.options.loop) {\n          self.play(self.options.startTime);\n        } else {\n          self.pause();\n        }\n      }\n    });\n    self.player.addEventListener('play', (e) => {\n      self.fire('play', e);\n    });\n    self.player.addEventListener('pause', (e) => {\n      self.fire('pause', e);\n    });\n    self.player.addEventListener('ended', (e) => {\n      self.fire('ended', e);\n    });\n    self.player.addEventListener('loadedmetadata', function () {\n      // get video width and height\n      self.videoWidth = this.videoWidth || 1280;\n      self.videoHeight = this.videoHeight || 720;\n\n      self.fire('ready');\n\n      // autoplay\n      if (self.options.autoplay) {\n        self.play(self.options.startTime);\n      }\n    });\n    self.player.addEventListener('volumechange', (e) => {\n      self.getVolume((volume) => {\n        self.options.volume = volume;\n      });\n      self.fire('volumechange', e);\n    });\n    self.player.addEventListener('error', (e) => {\n      self.fire('error', e);\n    });\n\n    callback(self.$video);\n  }\n}\n\nexport default VideoWorkerLocal;\n"],"names":["defaults","autoplay","loop","mute","volume","showControls","accessibilityHidden","startTime","endTime","win","ID","VideoWorkerBase","type","constructor","url","options","self","this","options_default","out","args","Object","keys","forEach","i","key","extend","videoID","parseURL","init","isValid","playerID","on","name","callback","userEventsList","push","off","val","fire","apply","static","play","start","pause","unmute","setVolume","getVolume","getMuted","setCurrentTime","currentTime","getCurrentTime","getImageURL","getVideo","window","global","global$1","Deferred","doneCallbacks","failCallbacks","prototype","execute","list","length","Array","slice","call","resolve","reject","done","fail","YoutubeAPIadded","loadingYoutubePlayer","loadingYoutubeDefer","VimeoAPIadded","loadingVimeoPlayer","loadingVimeoDefer","VideoWorker","result","providers","BaseClass","Youtube","match","super","tag","document","createElement","head","getElementsByTagName","src","appendChild","loadAPI","player","playVideo","seekTo","YT","PlayerState","PLAYING","getPlayerState","seconds","pauseVideo","unMute","isMuted","videoImage","availableSizes","step","tempImg","Image","onload","naturalWidth","width","$video","loaded","onYouTubeIframeAPIReady","onAPIready","hiddenDiv","ytStarted","ytProgressInterval","style","display","playerOptions","host","videoId","playerVars","autohide","rel","playsinline","iv_load_policy","modestbranding","controls","showinfo","disablekb","events","onReady","e","target","secondsOffset","getDuration","setInterval","onStateChange","data","ENDED","PAUSED","clearInterval","onError","firstInit","div","setAttribute","body","Player","getElementById","videoWidth","parseInt","getAttribute","videoHeight","Vimeo","found","getPaused","then","paused","innerWidth","devicePixelRatio","Math","min","request","XMLHttpRequest","open","onreadystatechange","readyState","status","response","JSON","parse","responseText","thumbnail_url","send","vimeoInterval","dnt","id","autopause","transparent","muted","urlHash","parseURLHash","h","background","playerOptionsString","encodeURIComponent","vmStarted","getVideoWidth","getVideoHeight","height","Local","videoFormats","split","ready","locStarted","element","source","addSourceElement","addEventListener"],"mappings":"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"}