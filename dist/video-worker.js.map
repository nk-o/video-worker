{"version":3,"file":"video-worker.js","sources":["../src/utils/global.js","../src/utils/deferred.js","../src/video-worker.js"],"sourcesContent":["/* eslint-disable import/no-mutable-exports */\n/* eslint-disable no-restricted-globals */\nlet win;\n\nif (typeof window !== 'undefined') {\n  win = window;\n} else if (typeof global !== 'undefined') {\n  win = global;\n} else if (typeof self !== 'undefined') {\n  win = self;\n} else {\n  win = {};\n}\n\nexport default win;\n","// Deferred\n// thanks http://stackoverflow.com/questions/18096715/implement-deferred-object-without-using-jquery\nfunction Deferred() {\n  this.doneCallbacks = [];\n  this.failCallbacks = [];\n}\n\nDeferred.prototype = {\n  execute(list, args) {\n    let i = list.length;\n    // eslint-disable-next-line no-param-reassign\n    args = Array.prototype.slice.call(args);\n\n    while (i) {\n      i -= 1;\n      list[i].apply(null, args);\n    }\n  },\n  resolve(...args) {\n    this.execute(this.doneCallbacks, args);\n  },\n  reject(...args) {\n    this.execute(this.failCallbacks, args);\n  },\n  done(callback) {\n    this.doneCallbacks.push(callback);\n  },\n  fail(callback) {\n    this.failCallbacks.push(callback);\n  },\n};\n\nexport default Deferred;\n","import global from './utils/global';\nimport Deferred from './utils/deferred';\n\nlet ID = 0;\nlet YoutubeAPIadded = 0;\nlet VimeoAPIadded = 0;\nlet loadingYoutubePlayer = 0;\nlet loadingVimeoPlayer = 0;\nconst loadingYoutubeDefer = new Deferred();\nconst loadingVimeoDefer = new Deferred();\n\nclass VideoWorker {\n  constructor(url, options) {\n    const self = this;\n\n    self.url = url;\n\n    self.options_default = {\n      autoplay: false,\n      loop: false,\n      mute: false,\n      volume: 100,\n      showControls: true,\n      accessibilityHidden: false,\n\n      // start / end video time in seconds\n      startTime: 0,\n      endTime: 0,\n    };\n\n    self.options = self.extend({}, self.options_default, options);\n\n    // Fix wrong option name.\n    // Thanks to https://github.com/nk-o/video-worker/issues/13.\n    if (typeof self.options.showContols !== 'undefined') {\n      self.options.showControls = self.options.showContols;\n      delete self.options.showContols;\n    }\n\n    // check URL\n    self.videoID = self.parseURL(url);\n\n    // init\n    if (self.videoID) {\n      self.ID = ID;\n      ID += 1;\n      self.loadAPI();\n      self.init();\n    }\n  }\n\n  // Extend like jQuery.extend\n  // eslint-disable-next-line class-methods-use-this\n  extend(...args) {\n    const out = args[0] || {};\n\n    Object.keys(args).forEach((i) => {\n      if (!args[i]) {\n        return;\n      }\n      Object.keys(args[i]).forEach((key) => {\n        out[key] = args[i][key];\n      });\n    });\n\n    return out;\n  }\n\n  parseURL(url) {\n    // parse youtube ID\n    function getYoutubeID(ytUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const regExp = /.*(?:youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=)([^#\\&\\?]*).*/;\n      const match = ytUrl.match(regExp);\n      return match && match[1].length === 11 ? match[1] : false;\n    }\n\n    // parse vimeo ID\n    function getVimeoID(vmUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const regExp =\n        /https?:\\/\\/(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/([^/]*)\\/videos\\/|album\\/(\\d+)\\/video\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/;\n      const match = vmUrl.match(regExp);\n      return match && match[3] ? match[3] : false;\n    }\n\n    // parse local string\n    function getLocalVideos(locUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const videoFormats = locUrl.split(/,(?=mp4\\:|webm\\:|ogv\\:|ogg\\:)/);\n      const result = {};\n      let ready = 0;\n      videoFormats.forEach((val) => {\n        // eslint-disable-next-line no-useless-escape\n        const match = val.match(/^(mp4|webm|ogv|ogg)\\:(.*)/);\n        if (match && match[1] && match[2]) {\n          // eslint-disable-next-line prefer-destructuring\n          result[match[1] === 'ogv' ? 'ogg' : match[1]] = match[2];\n          ready = 1;\n        }\n      });\n      return ready ? result : false;\n    }\n\n    const Youtube = getYoutubeID(url);\n    const Vimeo = getVimeoID(url);\n    const Local = getLocalVideos(url);\n\n    if (Youtube) {\n      this.type = 'youtube';\n      return Youtube;\n    }\n\n    if (Vimeo) {\n      this.type = 'vimeo';\n      return Vimeo;\n    }\n\n    if (Local) {\n      this.type = 'local';\n      return Local;\n    }\n\n    return false;\n  }\n\n  isValid() {\n    return !!this.videoID;\n  }\n\n  // events\n  on(name, callback) {\n    this.userEventsList = this.userEventsList || [];\n\n    // add new callback in events list\n    (this.userEventsList[name] || (this.userEventsList[name] = [])).push(callback);\n  }\n\n  off(name, callback) {\n    if (!this.userEventsList || !this.userEventsList[name]) {\n      return;\n    }\n\n    if (!callback) {\n      delete this.userEventsList[name];\n    } else {\n      this.userEventsList[name].forEach((val, key) => {\n        if (val === callback) {\n          this.userEventsList[name][key] = false;\n        }\n      });\n    }\n  }\n\n  fire(name, ...args) {\n    if (this.userEventsList && typeof this.userEventsList[name] !== 'undefined') {\n      this.userEventsList[name].forEach((val) => {\n        // call with all arguments\n        if (val) {\n          val.apply(this, args);\n        }\n      });\n    }\n  }\n\n  play(start) {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.playVideo) {\n      if (typeof start !== 'undefined') {\n        self.player.seekTo(start || 0);\n      }\n      if (global.YT.PlayerState.PLAYING !== self.player.getPlayerState()) {\n        self.player.playVideo();\n      }\n    }\n\n    if (self.type === 'vimeo') {\n      if (typeof start !== 'undefined') {\n        self.player.setCurrentTime(start);\n      }\n      self.player.getPaused().then((paused) => {\n        if (paused) {\n          self.player.play();\n        }\n      });\n    }\n\n    if (self.type === 'local') {\n      if (typeof start !== 'undefined') {\n        self.player.currentTime = start;\n      }\n      if (self.player.paused) {\n        self.player.play();\n      }\n    }\n  }\n\n  pause() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.pauseVideo) {\n      if (global.YT.PlayerState.PLAYING === self.player.getPlayerState()) {\n        self.player.pauseVideo();\n      }\n    }\n\n    if (self.type === 'vimeo') {\n      self.player.getPaused().then((paused) => {\n        if (!paused) {\n          self.player.pause();\n        }\n      });\n    }\n\n    if (self.type === 'local') {\n      if (!self.player.paused) {\n        self.player.pause();\n      }\n    }\n  }\n\n  mute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.mute) {\n      self.player.mute();\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(0);\n    }\n\n    if (self.type === 'local') {\n      self.$video.muted = true;\n    }\n  }\n\n  unmute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.mute) {\n      self.player.unMute();\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(self.options.volume);\n    }\n\n    if (self.type === 'local') {\n      self.$video.muted = false;\n    }\n  }\n\n  setVolume(volume = false) {\n    const self = this;\n    if (!self.player || !volume) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.setVolume) {\n      self.player.setVolume(volume);\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(volume);\n    }\n\n    if (self.type === 'local') {\n      self.$video.volume = volume / 100;\n    }\n  }\n\n  getVolume(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(false);\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.getVolume) {\n      callback(self.player.getVolume());\n    }\n\n    if (self.type === 'vimeo' && self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(volume);\n      });\n    }\n\n    if (self.type === 'local') {\n      callback(self.$video.volume * 100);\n    }\n  }\n\n  getMuted(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(null);\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.isMuted) {\n      callback(self.player.isMuted());\n    }\n\n    if (self.type === 'vimeo' && self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(!!volume);\n      });\n    }\n\n    if (self.type === 'local') {\n      callback(self.$video.muted);\n    }\n  }\n\n  getImageURL(callback) {\n    const self = this;\n\n    if (self.videoImage) {\n      callback(self.videoImage);\n      return;\n    }\n\n    if (self.type === 'youtube') {\n      const availableSizes = ['maxresdefault', 'sddefault', 'hqdefault', '0'];\n      let step = 0;\n\n      const tempImg = new Image();\n      tempImg.onload = function () {\n        // if no thumbnail, youtube add their own image with width = 120px\n        if ((this.naturalWidth || this.width) !== 120 || step === availableSizes.length - 1) {\n          // ok\n          self.videoImage = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n          callback(self.videoImage);\n        } else {\n          // try another size\n          step += 1;\n          this.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n        }\n      };\n      tempImg.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n    }\n\n    if (self.type === 'vimeo') {\n      let request = new XMLHttpRequest();\n      // https://vimeo.com/api/oembed.json?url=https://vimeo.com/235212527\n      request.open('GET', `https://vimeo.com/api/oembed.json?url=${self.url}`, true);\n      request.onreadystatechange = function () {\n        if (this.readyState === 4) {\n          if (this.status >= 200 && this.status < 400) {\n            // Success!\n            const response = JSON.parse(this.responseText);\n\n            if (response.thumbnail_url) {\n              self.videoImage = response.thumbnail_url;\n              callback(self.videoImage);\n            }\n          } else {\n            // Error :(\n          }\n        }\n      };\n      request.send();\n      request = null;\n    }\n  }\n\n  // fallback to the old version.\n  getIframe(callback) {\n    this.getVideo(callback);\n  }\n\n  getVideo(callback) {\n    const self = this;\n\n    // return generated video block\n    if (self.$video) {\n      callback(self.$video);\n      return;\n    }\n\n    // generate new video block\n    self.onAPIready(() => {\n      let hiddenDiv;\n      if (!self.$video) {\n        hiddenDiv = document.createElement('div');\n        hiddenDiv.style.display = 'none';\n      }\n\n      // Youtube\n      if (self.type === 'youtube') {\n        self.playerOptions = {\n          // GDPR Compliance.\n          host: 'https://www.youtube-nocookie.com',\n          videoId: self.videoID,\n          playerVars: {\n            autohide: 1,\n            rel: 0,\n            autoplay: 0,\n            // autoplay enable on mobile devices\n            playsinline: 1,\n          },\n        };\n\n        // hide controls\n        if (!self.options.showControls) {\n          self.playerOptions.playerVars.iv_load_policy = 3;\n          self.playerOptions.playerVars.modestbranding = 1;\n          self.playerOptions.playerVars.controls = 0;\n          self.playerOptions.playerVars.showinfo = 0;\n          self.playerOptions.playerVars.disablekb = 1;\n        }\n\n        // events\n        let ytStarted;\n        let ytProgressInterval;\n        self.playerOptions.events = {\n          onReady(e) {\n            // mute\n            if (self.options.mute) {\n              e.target.mute();\n            } else if (self.options.volume) {\n              e.target.setVolume(self.options.volume);\n            }\n\n            // autoplay\n            if (self.options.autoplay) {\n              self.play(self.options.startTime);\n            }\n            self.fire('ready', e);\n\n            // For seamless loops, set the endTime to 0.1 seconds less than the video's duration\n            // https://github.com/nk-o/video-worker/issues/2\n            if (self.options.loop && !self.options.endTime) {\n              const secondsOffset = 0.1;\n              self.options.endTime = self.player.getDuration() - secondsOffset;\n            }\n\n            // volumechange\n            setInterval(() => {\n              self.getVolume((volume) => {\n                if (self.options.volume !== volume) {\n                  self.options.volume = volume;\n                  self.fire('volumechange', e);\n                }\n              });\n            }, 150);\n          },\n          onStateChange(e) {\n            // loop\n            if (self.options.loop && e.data === global.YT.PlayerState.ENDED) {\n              self.play(self.options.startTime);\n            }\n            if (!ytStarted && e.data === global.YT.PlayerState.PLAYING) {\n              ytStarted = 1;\n              self.fire('started', e);\n            }\n            if (e.data === global.YT.PlayerState.PLAYING) {\n              self.fire('play', e);\n            }\n            if (e.data === global.YT.PlayerState.PAUSED) {\n              self.fire('pause', e);\n            }\n            if (e.data === global.YT.PlayerState.ENDED) {\n              self.fire('ended', e);\n            }\n\n            // progress check\n            if (e.data === global.YT.PlayerState.PLAYING) {\n              ytProgressInterval = setInterval(() => {\n                self.fire('timeupdate', e);\n\n                // check for end of video and play again or stop\n                if (self.options.endTime && self.player.getCurrentTime() >= self.options.endTime) {\n                  if (self.options.loop) {\n                    self.play(self.options.startTime);\n                  } else {\n                    self.pause();\n                  }\n                }\n              }, 150);\n            } else {\n              clearInterval(ytProgressInterval);\n            }\n          },\n          onError(e) {\n            self.fire('error', e);\n          },\n        };\n\n        const firstInit = !self.$video;\n        if (firstInit) {\n          const div = document.createElement('div');\n          div.setAttribute('id', self.playerID);\n          hiddenDiv.appendChild(div);\n          document.body.appendChild(hiddenDiv);\n        }\n        self.player = self.player || new global.YT.Player(self.playerID, self.playerOptions);\n        if (firstInit) {\n          self.$video = document.getElementById(self.playerID);\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          // get video width and height\n          self.videoWidth = parseInt(self.$video.getAttribute('width'), 10) || 1280;\n          self.videoHeight = parseInt(self.$video.getAttribute('height'), 10) || 720;\n        }\n      }\n\n      // Vimeo\n      if (self.type === 'vimeo') {\n        self.playerOptions = {\n          // GDPR Compliance.\n          dnt: 1,\n          id: self.videoID,\n          autopause: 0,\n          transparent: 0,\n          autoplay: self.options.autoplay ? 1 : 0,\n          loop: self.options.loop ? 1 : 0,\n          muted: self.options.mute ? 1 : 0,\n        };\n\n        if (self.options.volume) {\n          self.playerOptions.volume = self.options.volume;\n        }\n\n        // hide controls\n        if (!self.options.showControls) {\n          self.playerOptions.badge = 0;\n          self.playerOptions.byline = 0;\n          self.playerOptions.portrait = 0;\n          self.playerOptions.title = 0;\n          self.playerOptions.background = 1;\n        }\n\n        if (!self.$video) {\n          let playerOptionsString = '';\n          Object.keys(self.playerOptions).forEach((key) => {\n            if (playerOptionsString !== '') {\n              playerOptionsString += '&';\n            }\n            playerOptionsString += `${key}=${encodeURIComponent(self.playerOptions[key])}`;\n          });\n\n          // we need to create iframe manually because when we create it using API\n          // js events won't triggers after iframe moved to another place\n          self.$video = document.createElement('iframe');\n          self.$video.setAttribute('id', self.playerID);\n          self.$video.setAttribute(\n            'src',\n            `https://player.vimeo.com/video/${self.videoID}?${playerOptionsString}`\n          );\n          self.$video.setAttribute('frameborder', '0');\n          self.$video.setAttribute('mozallowfullscreen', '');\n          self.$video.setAttribute('allowfullscreen', '');\n          self.$video.setAttribute('title', 'Vimeo video player');\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          hiddenDiv.appendChild(self.$video);\n          document.body.appendChild(hiddenDiv);\n        }\n        self.player = self.player || new global.Vimeo.Player(self.$video, self.playerOptions);\n\n        // set current time for autoplay\n        if (self.options.startTime && self.options.autoplay) {\n          self.player.setCurrentTime(self.options.startTime);\n        }\n\n        // get video width and height\n        self.player.getVideoWidth().then((width) => {\n          self.videoWidth = width || 1280;\n        });\n        self.player.getVideoHeight().then((height) => {\n          self.videoHeight = height || 720;\n        });\n\n        // events\n        let vmStarted;\n        self.player.on('timeupdate', (e) => {\n          if (!vmStarted) {\n            self.fire('started', e);\n            vmStarted = 1;\n          }\n\n          self.fire('timeupdate', e);\n\n          // check for end of video and play again or stop\n          if (self.options.endTime) {\n            if (self.options.endTime && e.seconds >= self.options.endTime) {\n              if (self.options.loop) {\n                self.play(self.options.startTime);\n              } else {\n                self.pause();\n              }\n            }\n          }\n        });\n        self.player.on('play', (e) => {\n          self.fire('play', e);\n\n          // check for the start time and start with it\n          if (self.options.startTime && e.seconds === 0) {\n            self.play(self.options.startTime);\n          }\n        });\n        self.player.on('pause', (e) => {\n          self.fire('pause', e);\n        });\n        self.player.on('ended', (e) => {\n          self.fire('ended', e);\n        });\n        self.player.on('loaded', (e) => {\n          self.fire('ready', e);\n        });\n        self.player.on('volumechange', (e) => {\n          self.fire('volumechange', e);\n        });\n        self.player.on('error', (e) => {\n          self.fire('error', e);\n        });\n      }\n\n      // Local\n      function addSourceToLocal(element, src, type) {\n        const source = document.createElement('source');\n        source.src = src;\n        source.type = type;\n        element.appendChild(source);\n      }\n      if (self.type === 'local') {\n        if (!self.$video) {\n          self.$video = document.createElement('video');\n\n          // show controls\n          if (self.options.showControls) {\n            self.$video.controls = true;\n          }\n\n          // mute\n          if (self.options.mute) {\n            self.$video.muted = true;\n          } else if (self.$video.volume) {\n            self.$video.volume = self.options.volume / 100;\n          }\n\n          // loop\n          if (self.options.loop) {\n            self.$video.loop = true;\n          }\n\n          // autoplay enable on mobile devices\n          self.$video.setAttribute('playsinline', '');\n          self.$video.setAttribute('webkit-playsinline', '');\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          self.$video.setAttribute('id', self.playerID);\n          hiddenDiv.appendChild(self.$video);\n          document.body.appendChild(hiddenDiv);\n\n          Object.keys(self.videoID).forEach((key) => {\n            addSourceToLocal(self.$video, self.videoID[key], `video/${key}`);\n          });\n        }\n\n        self.player = self.player || self.$video;\n\n        let locStarted;\n        self.player.addEventListener('playing', (e) => {\n          if (!locStarted) {\n            self.fire('started', e);\n          }\n          locStarted = 1;\n        });\n        self.player.addEventListener('timeupdate', function (e) {\n          self.fire('timeupdate', e);\n\n          // check for end of video and play again or stop\n          if (self.options.endTime) {\n            if (self.options.endTime && this.currentTime >= self.options.endTime) {\n              if (self.options.loop) {\n                self.play(self.options.startTime);\n              } else {\n                self.pause();\n              }\n            }\n          }\n        });\n        self.player.addEventListener('play', (e) => {\n          self.fire('play', e);\n        });\n        self.player.addEventListener('pause', (e) => {\n          self.fire('pause', e);\n        });\n        self.player.addEventListener('ended', (e) => {\n          self.fire('ended', e);\n        });\n        self.player.addEventListener('loadedmetadata', function () {\n          // get video width and height\n          self.videoWidth = this.videoWidth || 1280;\n          self.videoHeight = this.videoHeight || 720;\n\n          self.fire('ready');\n\n          // autoplay\n          if (self.options.autoplay) {\n            self.play(self.options.startTime);\n          }\n        });\n        self.player.addEventListener('volumechange', (e) => {\n          self.getVolume((volume) => {\n            self.options.volume = volume;\n          });\n          self.fire('volumechange', e);\n        });\n        self.player.addEventListener('error', (e) => {\n          self.fire('error', e);\n        });\n      }\n      callback(self.$video);\n    });\n  }\n\n  init() {\n    const self = this;\n\n    self.playerID = `VideoWorker-${self.ID}`;\n  }\n\n  loadAPI() {\n    const self = this;\n\n    if (YoutubeAPIadded && VimeoAPIadded) {\n      return;\n    }\n\n    let src = '';\n\n    // load Youtube API\n    if (self.type === 'youtube' && !YoutubeAPIadded) {\n      YoutubeAPIadded = 1;\n      src = 'https://www.youtube.com/iframe_api';\n    }\n\n    // load Vimeo API\n    if (self.type === 'vimeo' && !VimeoAPIadded) {\n      VimeoAPIadded = 1;\n\n      // Useful when Vimeo API added using RequireJS https://github.com/nk-o/video-worker/pull/7\n      if (typeof global.Vimeo !== 'undefined') {\n        return;\n      }\n\n      src = 'https://player.vimeo.com/api/player.js';\n    }\n\n    if (!src) {\n      return;\n    }\n\n    // add script in head section\n    let tag = document.createElement('script');\n    let head = document.getElementsByTagName('head')[0];\n    tag.src = src;\n\n    head.appendChild(tag);\n\n    head = null;\n    tag = null;\n  }\n\n  onAPIready(callback) {\n    const self = this;\n\n    // Youtube\n    if (self.type === 'youtube') {\n      // Listen for global YT player callback\n      if ((typeof global.YT === 'undefined' || global.YT.loaded === 0) && !loadingYoutubePlayer) {\n        // Prevents Ready event from being called twice\n        loadingYoutubePlayer = 1;\n\n        // Creates deferred so, other players know when to wait.\n        global.onYouTubeIframeAPIReady = function () {\n          global.onYouTubeIframeAPIReady = null;\n          loadingYoutubeDefer.resolve('done');\n          callback();\n        };\n      } else if (typeof global.YT === 'object' && global.YT.loaded === 1) {\n        callback();\n      } else {\n        loadingYoutubeDefer.done(() => {\n          callback();\n        });\n      }\n    }\n\n    // Vimeo\n    if (self.type === 'vimeo') {\n      if (typeof global.Vimeo === 'undefined' && !loadingVimeoPlayer) {\n        loadingVimeoPlayer = 1;\n        const vimeoInterval = setInterval(() => {\n          if (typeof global.Vimeo !== 'undefined') {\n            clearInterval(vimeoInterval);\n            loadingVimeoDefer.resolve('done');\n            callback();\n          }\n        }, 20);\n      } else if (typeof global.Vimeo !== 'undefined') {\n        callback();\n      } else {\n        loadingVimeoDefer.done(() => {\n          callback();\n        });\n      }\n    }\n\n    // Local\n    if (self.type === 'local') {\n      callback();\n    }\n  }\n}\n\nexport default VideoWorker;\n"],"names":["win","window","global","self","Deferred","doneCallbacks","failCallbacks","prototype","execute","list","args","i","length","Array","slice","call","apply","resolve","reject","done","callback","push","fail","ID","YoutubeAPIadded","VimeoAPIadded","loadingYoutubePlayer","loadingVimeoPlayer","loadingYoutubeDefer","loadingVimeoDefer","VideoWorker","constructor","url","options","options_default","autoplay","loop","mute","volume","showControls","accessibilityHidden","startTime","endTime","extend","showContols","videoID","parseURL","loadAPI","init","out","Object","keys","forEach","key","getYoutubeID","ytUrl","regExp","match","getVimeoID","vmUrl","getLocalVideos","locUrl","videoFormats","split","result","ready","val","Youtube","Vimeo","Local","type","isValid","on","name","userEventsList","off","fire","play","start","player","playVideo","seekTo","YT","PlayerState","PLAYING","getPlayerState","setCurrentTime","getPaused","then","paused","currentTime","pause","pauseVideo","setVolume","$video","muted","unmute","unMute","getVolume","getMuted","isMuted","getImageURL","videoImage","availableSizes","step","tempImg","Image","onload","naturalWidth","width","src","request","XMLHttpRequest","open","onreadystatechange","readyState","status","response","JSON","parse","responseText","thumbnail_url","send","getIframe","getVideo","onAPIready","hiddenDiv","document","createElement","style","display","playerOptions","host","videoId","playerVars","autohide","rel","playsinline","iv_load_policy","modestbranding","controls","showinfo","disablekb","ytStarted","ytProgressInterval","events","onReady","e","target","secondsOffset","getDuration","setInterval","onStateChange","data","ENDED","PAUSED","getCurrentTime","clearInterval","onError","firstInit","div","setAttribute","playerID","appendChild","body","Player","getElementById","videoWidth","parseInt","getAttribute","videoHeight","dnt","id","autopause","transparent","badge","byline","portrait","title","background","playerOptionsString","encodeURIComponent","getVideoWidth","getVideoHeight","height","vmStarted","seconds","addSourceToLocal","element","source","locStarted","addEventListener","tag","head","getElementsByTagName","loaded","onYouTubeIframeAPIReady","vimeoInterval"],"mappings":"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"}