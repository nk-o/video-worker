{"version":3,"file":"video-worker.js","sources":["../src/utils/global.js","../src/utils/deferred.js","../src/video-worker.js"],"sourcesContent":["/* eslint-disable import/no-mutable-exports */\n/* eslint-disable no-restricted-globals */\nlet win;\n\nif (typeof window !== 'undefined') {\n  win = window;\n} else if (typeof global !== 'undefined') {\n  win = global;\n} else if (typeof self !== 'undefined') {\n  win = self;\n} else {\n  win = {};\n}\n\nexport default win;\n","// Deferred\n// thanks http://stackoverflow.com/questions/18096715/implement-deferred-object-without-using-jquery\nfunction Deferred() {\n  this.doneCallbacks = [];\n  this.failCallbacks = [];\n}\n\nDeferred.prototype = {\n  execute(list, args) {\n    let i = list.length;\n    // eslint-disable-next-line no-param-reassign\n    args = Array.prototype.slice.call(args);\n\n    while (i) {\n      i -= 1;\n      list[i].apply(null, args);\n    }\n  },\n  resolve(...args) {\n    this.execute(this.doneCallbacks, args);\n  },\n  reject(...args) {\n    this.execute(this.failCallbacks, args);\n  },\n  done(callback) {\n    this.doneCallbacks.push(callback);\n  },\n  fail(callback) {\n    this.failCallbacks.push(callback);\n  },\n};\n\nexport default Deferred;\n","import global from './utils/global';\nimport Deferred from './utils/deferred';\n\nlet ID = 0;\nlet YoutubeAPIadded = 0;\nlet VimeoAPIadded = 0;\nlet loadingYoutubePlayer = 0;\nlet loadingVimeoPlayer = 0;\nconst loadingYoutubeDefer = new Deferred();\nconst loadingVimeoDefer = new Deferred();\n\nclass VideoWorker {\n  constructor(url, options) {\n    const self = this;\n\n    self.url = url;\n\n    self.options_default = {\n      autoplay: false,\n      loop: false,\n      mute: false,\n      volume: 100,\n      showControls: true,\n      accessibilityHidden: false,\n\n      // start / end video time in seconds\n      startTime: 0,\n      endTime: 0,\n    };\n\n    self.options = self.extend({}, self.options_default, options);\n\n    // Fix wrong option name.\n    // Thanks to https://github.com/nk-o/video-worker/issues/13.\n    if (typeof self.options.showContols !== 'undefined') {\n      self.options.showControls = self.options.showContols;\n      delete self.options.showContols;\n    }\n\n    // check URL\n    self.videoID = self.parseURL(url);\n\n    // init\n    if (self.videoID) {\n      self.ID = ID;\n      ID += 1;\n      self.loadAPI();\n      self.init();\n    }\n  }\n\n  // Extend like jQuery.extend\n  // eslint-disable-next-line class-methods-use-this\n  extend(...args) {\n    const out = args[0] || {};\n\n    Object.keys(args).forEach((i) => {\n      if (!args[i]) {\n        return;\n      }\n      Object.keys(args[i]).forEach((key) => {\n        out[key] = args[i][key];\n      });\n    });\n\n    return out;\n  }\n\n  parseURL(url) {\n    // parse youtube ID\n    function getYoutubeID(ytUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const regExp = /.*(?:youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=)([^#\\&\\?]*).*/;\n      const match = ytUrl.match(regExp);\n      return match && match[1].length === 11 ? match[1] : false;\n    }\n\n    // parse vimeo ID\n    function getVimeoID(vmUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const regExp =\n        /https?:\\/\\/(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/([^/]*)\\/videos\\/|album\\/(\\d+)\\/video\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/;\n      const match = vmUrl.match(regExp);\n      return match && match[3] ? match[3] : false;\n    }\n\n    // parse local string\n    function getLocalVideos(locUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const videoFormats = locUrl.split(/,(?=mp4\\:|webm\\:|ogv\\:|ogg\\:)/);\n      const result = {};\n      let ready = 0;\n      videoFormats.forEach((val) => {\n        // eslint-disable-next-line no-useless-escape\n        const match = val.match(/^(mp4|webm|ogv|ogg)\\:(.*)/);\n        if (match && match[1] && match[2]) {\n          // eslint-disable-next-line prefer-destructuring\n          result[match[1] === 'ogv' ? 'ogg' : match[1]] = match[2];\n          ready = 1;\n        }\n      });\n      return ready ? result : false;\n    }\n\n    const Youtube = getYoutubeID(url);\n    const Vimeo = getVimeoID(url);\n    const Local = getLocalVideos(url);\n\n    if (Youtube) {\n      this.type = 'youtube';\n      return Youtube;\n    }\n\n    if (Vimeo) {\n      this.type = 'vimeo';\n      return Vimeo;\n    }\n\n    if (Local) {\n      this.type = 'local';\n      return Local;\n    }\n\n    return false;\n  }\n\n  isValid() {\n    return !!this.videoID;\n  }\n\n  // events\n  on(name, callback) {\n    this.userEventsList = this.userEventsList || [];\n\n    // add new callback in events list\n    (this.userEventsList[name] || (this.userEventsList[name] = [])).push(callback);\n  }\n\n  off(name, callback) {\n    if (!this.userEventsList || !this.userEventsList[name]) {\n      return;\n    }\n\n    if (!callback) {\n      delete this.userEventsList[name];\n    } else {\n      this.userEventsList[name].forEach((val, key) => {\n        if (val === callback) {\n          this.userEventsList[name][key] = false;\n        }\n      });\n    }\n  }\n\n  fire(name, ...args) {\n    if (this.userEventsList && typeof this.userEventsList[name] !== 'undefined') {\n      this.userEventsList[name].forEach((val) => {\n        // call with all arguments\n        if (val) {\n          val.apply(this, args);\n        }\n      });\n    }\n  }\n\n  play(start) {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.playVideo) {\n      if (typeof start !== 'undefined') {\n        self.player.seekTo(start || 0);\n      }\n      if (global.YT.PlayerState.PLAYING !== self.player.getPlayerState()) {\n        self.player.playVideo();\n      }\n    }\n\n    if (self.type === 'vimeo') {\n      if (typeof start !== 'undefined') {\n        self.player.setCurrentTime(start);\n      }\n      self.player.getPaused().then((paused) => {\n        if (paused) {\n          self.player.play();\n        }\n      });\n    }\n\n    if (self.type === 'local') {\n      if (typeof start !== 'undefined') {\n        self.player.currentTime = start;\n      }\n      if (self.player.paused) {\n        self.player.play();\n      }\n    }\n  }\n\n  pause() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.pauseVideo) {\n      if (global.YT.PlayerState.PLAYING === self.player.getPlayerState()) {\n        self.player.pauseVideo();\n      }\n    }\n\n    if (self.type === 'vimeo') {\n      self.player.getPaused().then((paused) => {\n        if (!paused) {\n          self.player.pause();\n        }\n      });\n    }\n\n    if (self.type === 'local') {\n      if (!self.player.paused) {\n        self.player.pause();\n      }\n    }\n  }\n\n  mute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.mute) {\n      self.player.mute();\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(0);\n    }\n\n    if (self.type === 'local') {\n      self.$video.muted = true;\n    }\n  }\n\n  unmute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.mute) {\n      self.player.unMute();\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(self.options.volume);\n    }\n\n    if (self.type === 'local') {\n      self.$video.muted = false;\n    }\n  }\n\n  setVolume(volume = false) {\n    const self = this;\n    if (!self.player || !volume) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.setVolume) {\n      self.player.setVolume(volume);\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(volume);\n    }\n\n    if (self.type === 'local') {\n      self.$video.volume = volume / 100;\n    }\n  }\n\n  getVolume(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(false);\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.getVolume) {\n      callback(self.player.getVolume());\n    }\n\n    if (self.type === 'vimeo' && self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(volume);\n      });\n    }\n\n    if (self.type === 'local') {\n      callback(self.$video.volume * 100);\n    }\n  }\n\n  getMuted(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(null);\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.isMuted) {\n      callback(self.player.isMuted());\n    }\n\n    if (self.type === 'vimeo' && self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(!!volume);\n      });\n    }\n\n    if (self.type === 'local') {\n      callback(self.$video.muted);\n    }\n  }\n\n  getImageURL(callback) {\n    const self = this;\n\n    if (self.videoImage) {\n      callback(self.videoImage);\n      return;\n    }\n\n    if (self.type === 'youtube') {\n      const availableSizes = ['maxresdefault', 'sddefault', 'hqdefault', '0'];\n      let step = 0;\n\n      const tempImg = new Image();\n      tempImg.onload = function () {\n        // if no thumbnail, youtube add their own image with width = 120px\n        if ((this.naturalWidth || this.width) !== 120 || step === availableSizes.length - 1) {\n          // ok\n          self.videoImage = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n          callback(self.videoImage);\n        } else {\n          // try another size\n          step += 1;\n          this.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n        }\n      };\n      tempImg.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n    }\n\n    if (self.type === 'vimeo') {\n      // We should provide width to get HQ thumbnail URL.\n      let width = global.innerWidth || 1920;\n      if (global.devicePixelRatio) {\n        width *= global.devicePixelRatio;\n      }\n      width = Math.min(width, 1920);\n\n      let request = new XMLHttpRequest();\n      // https://vimeo.com/api/oembed.json?url=https://vimeo.com/235212527\n      request.open('GET', `https://vimeo.com/api/oembed.json?url=${self.url}&width=${width}`, true);\n      request.onreadystatechange = function () {\n        if (this.readyState === 4) {\n          if (this.status >= 200 && this.status < 400) {\n            // Success!\n            const response = JSON.parse(this.responseText);\n\n            if (response.thumbnail_url) {\n              self.videoImage = response.thumbnail_url;\n              callback(self.videoImage);\n            }\n          } else {\n            // Error :(\n          }\n        }\n      };\n      request.send();\n      request = null;\n    }\n  }\n\n  // fallback to the old version.\n  getIframe(callback) {\n    this.getVideo(callback);\n  }\n\n  getVideo(callback) {\n    const self = this;\n\n    // return generated video block\n    if (self.$video) {\n      callback(self.$video);\n      return;\n    }\n\n    // generate new video block\n    self.onAPIready(() => {\n      let hiddenDiv;\n      if (!self.$video) {\n        hiddenDiv = document.createElement('div');\n        hiddenDiv.style.display = 'none';\n      }\n\n      // Youtube\n      if (self.type === 'youtube') {\n        self.playerOptions = {\n          // GDPR Compliance.\n          host: 'https://www.youtube-nocookie.com',\n          videoId: self.videoID,\n          playerVars: {\n            autohide: 1,\n            rel: 0,\n            autoplay: 0,\n            // autoplay enable on mobile devices\n            playsinline: 1,\n          },\n        };\n\n        // hide controls\n        if (!self.options.showControls) {\n          self.playerOptions.playerVars.iv_load_policy = 3;\n          self.playerOptions.playerVars.modestbranding = 1;\n          self.playerOptions.playerVars.controls = 0;\n          self.playerOptions.playerVars.showinfo = 0;\n          self.playerOptions.playerVars.disablekb = 1;\n        }\n\n        // events\n        let ytStarted;\n        let ytProgressInterval;\n        self.playerOptions.events = {\n          onReady(e) {\n            // mute\n            if (self.options.mute) {\n              e.target.mute();\n            } else if (self.options.volume) {\n              e.target.setVolume(self.options.volume);\n            }\n\n            // autoplay\n            if (self.options.autoplay) {\n              self.play(self.options.startTime);\n            }\n            self.fire('ready', e);\n\n            // For seamless loops, set the endTime to 0.1 seconds less than the video's duration\n            // https://github.com/nk-o/video-worker/issues/2\n            if (self.options.loop && !self.options.endTime) {\n              const secondsOffset = 0.1;\n              self.options.endTime = self.player.getDuration() - secondsOffset;\n            }\n\n            // volumechange\n            setInterval(() => {\n              self.getVolume((volume) => {\n                if (self.options.volume !== volume) {\n                  self.options.volume = volume;\n                  self.fire('volumechange', e);\n                }\n              });\n            }, 150);\n          },\n          onStateChange(e) {\n            // loop\n            if (self.options.loop && e.data === global.YT.PlayerState.ENDED) {\n              self.play(self.options.startTime);\n            }\n            if (!ytStarted && e.data === global.YT.PlayerState.PLAYING) {\n              ytStarted = 1;\n              self.fire('started', e);\n            }\n            if (e.data === global.YT.PlayerState.PLAYING) {\n              self.fire('play', e);\n            }\n            if (e.data === global.YT.PlayerState.PAUSED) {\n              self.fire('pause', e);\n            }\n            if (e.data === global.YT.PlayerState.ENDED) {\n              self.fire('ended', e);\n            }\n\n            // progress check\n            if (e.data === global.YT.PlayerState.PLAYING) {\n              ytProgressInterval = setInterval(() => {\n                self.fire('timeupdate', e);\n\n                // check for end of video and play again or stop\n                if (self.options.endTime && self.player.getCurrentTime() >= self.options.endTime) {\n                  if (self.options.loop) {\n                    self.play(self.options.startTime);\n                  } else {\n                    self.pause();\n                  }\n                }\n              }, 150);\n            } else {\n              clearInterval(ytProgressInterval);\n            }\n          },\n          onError(e) {\n            self.fire('error', e);\n          },\n        };\n\n        const firstInit = !self.$video;\n        if (firstInit) {\n          const div = document.createElement('div');\n          div.setAttribute('id', self.playerID);\n          hiddenDiv.appendChild(div);\n          document.body.appendChild(hiddenDiv);\n        }\n        self.player = self.player || new global.YT.Player(self.playerID, self.playerOptions);\n        if (firstInit) {\n          self.$video = document.getElementById(self.playerID);\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          // get video width and height\n          self.videoWidth = parseInt(self.$video.getAttribute('width'), 10) || 1280;\n          self.videoHeight = parseInt(self.$video.getAttribute('height'), 10) || 720;\n        }\n      }\n\n      // Vimeo\n      if (self.type === 'vimeo') {\n        self.playerOptions = {\n          // GDPR Compliance.\n          dnt: 1,\n          id: self.videoID,\n          autopause: 0,\n          transparent: 0,\n          autoplay: self.options.autoplay ? 1 : 0,\n          loop: self.options.loop ? 1 : 0,\n          muted: self.options.mute ? 1 : 0,\n        };\n\n        if (self.options.volume) {\n          self.playerOptions.volume = self.options.volume;\n        }\n\n        // hide controls\n        if (!self.options.showControls) {\n          self.playerOptions.badge = 0;\n          self.playerOptions.byline = 0;\n          self.playerOptions.portrait = 0;\n          self.playerOptions.title = 0;\n          self.playerOptions.background = 1;\n        }\n\n        if (!self.$video) {\n          let playerOptionsString = '';\n          Object.keys(self.playerOptions).forEach((key) => {\n            if (playerOptionsString !== '') {\n              playerOptionsString += '&';\n            }\n            playerOptionsString += `${key}=${encodeURIComponent(self.playerOptions[key])}`;\n          });\n\n          // we need to create iframe manually because when we create it using API\n          // js events won't triggers after iframe moved to another place\n          self.$video = document.createElement('iframe');\n          self.$video.setAttribute('id', self.playerID);\n          self.$video.setAttribute(\n            'src',\n            `https://player.vimeo.com/video/${self.videoID}?${playerOptionsString}`\n          );\n          self.$video.setAttribute('frameborder', '0');\n          self.$video.setAttribute('mozallowfullscreen', '');\n          self.$video.setAttribute('allowfullscreen', '');\n          self.$video.setAttribute('title', 'Vimeo video player');\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          hiddenDiv.appendChild(self.$video);\n          document.body.appendChild(hiddenDiv);\n        }\n        self.player = self.player || new global.Vimeo.Player(self.$video, self.playerOptions);\n\n        // set current time for autoplay\n        if (self.options.startTime && self.options.autoplay) {\n          self.player.setCurrentTime(self.options.startTime);\n        }\n\n        // get video width and height\n        self.player.getVideoWidth().then((width) => {\n          self.videoWidth = width || 1280;\n        });\n        self.player.getVideoHeight().then((height) => {\n          self.videoHeight = height || 720;\n        });\n\n        // events\n        let vmStarted;\n        self.player.on('timeupdate', (e) => {\n          if (!vmStarted) {\n            self.fire('started', e);\n            vmStarted = 1;\n          }\n\n          self.fire('timeupdate', e);\n\n          // check for end of video and play again or stop\n          if (self.options.endTime) {\n            if (self.options.endTime && e.seconds >= self.options.endTime) {\n              if (self.options.loop) {\n                self.play(self.options.startTime);\n              } else {\n                self.pause();\n              }\n            }\n          }\n        });\n        self.player.on('play', (e) => {\n          self.fire('play', e);\n\n          // check for the start time and start with it\n          if (self.options.startTime && e.seconds === 0) {\n            self.play(self.options.startTime);\n          }\n        });\n        self.player.on('pause', (e) => {\n          self.fire('pause', e);\n        });\n        self.player.on('ended', (e) => {\n          self.fire('ended', e);\n        });\n        self.player.on('loaded', (e) => {\n          self.fire('ready', e);\n        });\n        self.player.on('volumechange', (e) => {\n          self.fire('volumechange', e);\n        });\n        self.player.on('error', (e) => {\n          self.fire('error', e);\n        });\n      }\n\n      // Local\n      function addSourceToLocal(element, src, type) {\n        const source = document.createElement('source');\n        source.src = src;\n        source.type = type;\n        element.appendChild(source);\n      }\n      if (self.type === 'local') {\n        if (!self.$video) {\n          self.$video = document.createElement('video');\n\n          // show controls\n          if (self.options.showControls) {\n            self.$video.controls = true;\n          }\n\n          // mute\n          if (self.options.mute) {\n            self.$video.muted = true;\n          } else if (self.$video.volume) {\n            self.$video.volume = self.options.volume / 100;\n          }\n\n          // loop\n          if (self.options.loop) {\n            self.$video.loop = true;\n          }\n\n          // autoplay enable on mobile devices\n          self.$video.setAttribute('playsinline', '');\n          self.$video.setAttribute('webkit-playsinline', '');\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          self.$video.setAttribute('id', self.playerID);\n          hiddenDiv.appendChild(self.$video);\n          document.body.appendChild(hiddenDiv);\n\n          Object.keys(self.videoID).forEach((key) => {\n            addSourceToLocal(self.$video, self.videoID[key], `video/${key}`);\n          });\n        }\n\n        self.player = self.player || self.$video;\n\n        let locStarted;\n        self.player.addEventListener('playing', (e) => {\n          if (!locStarted) {\n            self.fire('started', e);\n          }\n          locStarted = 1;\n        });\n        self.player.addEventListener('timeupdate', function (e) {\n          self.fire('timeupdate', e);\n\n          // check for end of video and play again or stop\n          if (self.options.endTime) {\n            if (self.options.endTime && this.currentTime >= self.options.endTime) {\n              if (self.options.loop) {\n                self.play(self.options.startTime);\n              } else {\n                self.pause();\n              }\n            }\n          }\n        });\n        self.player.addEventListener('play', (e) => {\n          self.fire('play', e);\n        });\n        self.player.addEventListener('pause', (e) => {\n          self.fire('pause', e);\n        });\n        self.player.addEventListener('ended', (e) => {\n          self.fire('ended', e);\n        });\n        self.player.addEventListener('loadedmetadata', function () {\n          // get video width and height\n          self.videoWidth = this.videoWidth || 1280;\n          self.videoHeight = this.videoHeight || 720;\n\n          self.fire('ready');\n\n          // autoplay\n          if (self.options.autoplay) {\n            self.play(self.options.startTime);\n          }\n        });\n        self.player.addEventListener('volumechange', (e) => {\n          self.getVolume((volume) => {\n            self.options.volume = volume;\n          });\n          self.fire('volumechange', e);\n        });\n        self.player.addEventListener('error', (e) => {\n          self.fire('error', e);\n        });\n      }\n      callback(self.$video);\n    });\n  }\n\n  init() {\n    const self = this;\n\n    self.playerID = `VideoWorker-${self.ID}`;\n  }\n\n  loadAPI() {\n    const self = this;\n\n    if (YoutubeAPIadded && VimeoAPIadded) {\n      return;\n    }\n\n    let src = '';\n\n    // load Youtube API\n    if (self.type === 'youtube' && !YoutubeAPIadded) {\n      YoutubeAPIadded = 1;\n      src = 'https://www.youtube.com/iframe_api';\n    }\n\n    // load Vimeo API\n    if (self.type === 'vimeo' && !VimeoAPIadded) {\n      VimeoAPIadded = 1;\n\n      // Useful when Vimeo API added using RequireJS https://github.com/nk-o/video-worker/pull/7\n      if (typeof global.Vimeo !== 'undefined') {\n        return;\n      }\n\n      src = 'https://player.vimeo.com/api/player.js';\n    }\n\n    if (!src) {\n      return;\n    }\n\n    // add script in head section\n    let tag = document.createElement('script');\n    let head = document.getElementsByTagName('head')[0];\n    tag.src = src;\n\n    head.appendChild(tag);\n\n    head = null;\n    tag = null;\n  }\n\n  onAPIready(callback) {\n    const self = this;\n\n    // Youtube\n    if (self.type === 'youtube') {\n      // Listen for global YT player callback\n      if ((typeof global.YT === 'undefined' || global.YT.loaded === 0) && !loadingYoutubePlayer) {\n        // Prevents Ready event from being called twice\n        loadingYoutubePlayer = 1;\n\n        // Creates deferred so, other players know when to wait.\n        global.onYouTubeIframeAPIReady = function () {\n          global.onYouTubeIframeAPIReady = null;\n          loadingYoutubeDefer.resolve('done');\n          callback();\n        };\n      } else if (typeof global.YT === 'object' && global.YT.loaded === 1) {\n        callback();\n      } else {\n        loadingYoutubeDefer.done(() => {\n          callback();\n        });\n      }\n    }\n\n    // Vimeo\n    if (self.type === 'vimeo') {\n      if (typeof global.Vimeo === 'undefined' && !loadingVimeoPlayer) {\n        loadingVimeoPlayer = 1;\n        const vimeoInterval = setInterval(() => {\n          if (typeof global.Vimeo !== 'undefined') {\n            clearInterval(vimeoInterval);\n            loadingVimeoDefer.resolve('done');\n            callback();\n          }\n        }, 20);\n      } else if (typeof global.Vimeo !== 'undefined') {\n        callback();\n      } else {\n        loadingVimeoDefer.done(() => {\n          callback();\n        });\n      }\n    }\n\n    // Local\n    if (self.type === 'local') {\n      callback();\n    }\n  }\n}\n\nexport default VideoWorker;\n"],"names":["win","window","global","self","Deferred","doneCallbacks","failCallbacks","prototype","execute","list","args","i","length","Array","slice","call","apply","resolve","reject","done","callback","push","fail","ID","YoutubeAPIadded","VimeoAPIadded","loadingYoutubePlayer","loadingVimeoPlayer","loadingYoutubeDefer","loadingVimeoDefer","VideoWorker","constructor","url","options","options_default","autoplay","loop","mute","volume","showControls","accessibilityHidden","startTime","endTime","extend","showContols","videoID","parseURL","loadAPI","init","out","Object","keys","forEach","key","getYoutubeID","ytUrl","regExp","match","getVimeoID","vmUrl","getLocalVideos","locUrl","videoFormats","split","result","ready","val","Youtube","Vimeo","Local","type","isValid","on","name","userEventsList","off","fire","play","start","player","playVideo","seekTo","YT","PlayerState","PLAYING","getPlayerState","setCurrentTime","getPaused","then","paused","currentTime","pause","pauseVideo","setVolume","$video","muted","unmute","unMute","getVolume","getMuted","isMuted","getImageURL","videoImage","availableSizes","step","tempImg","Image","onload","naturalWidth","width","src","innerWidth","devicePixelRatio","Math","min","request","XMLHttpRequest","open","onreadystatechange","readyState","status","response","JSON","parse","responseText","thumbnail_url","send","getIframe","getVideo","onAPIready","hiddenDiv","document","createElement","style","display","playerOptions","host","videoId","playerVars","autohide","rel","playsinline","iv_load_policy","modestbranding","controls","showinfo","disablekb","ytStarted","ytProgressInterval","events","onReady","e","target","secondsOffset","getDuration","setInterval","onStateChange","data","ENDED","PAUSED","getCurrentTime","clearInterval","onError","firstInit","div","setAttribute","playerID","appendChild","body","Player","getElementById","videoWidth","parseInt","getAttribute","videoHeight","dnt","id","autopause","transparent","badge","byline","portrait","title","background","playerOptionsString","encodeURIComponent","getVideoWidth","getVideoHeight","height","vmStarted","seconds","addSourceToLocal","element","source","locStarted","addEventListener","tag","head","getElementsByTagName","loaded","onYouTubeIframeAPIReady","vimeoInterval"],"mappings":"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"}