{"version":3,"file":"video-worker.cjs","sources":["../src/utils/global.js","../src/utils/deferred.js","../src/video-worker.js"],"sourcesContent":["/* eslint-disable import/no-mutable-exports */\n/* eslint-disable no-restricted-globals */\nlet win;\n\nif (typeof window !== 'undefined') {\n  win = window;\n} else if (typeof global !== 'undefined') {\n  win = global;\n} else if (typeof self !== 'undefined') {\n  win = self;\n} else {\n  win = {};\n}\n\nexport default win;\n","// Deferred\n// thanks http://stackoverflow.com/questions/18096715/implement-deferred-object-without-using-jquery\nfunction Deferred() {\n  this.doneCallbacks = [];\n  this.failCallbacks = [];\n}\n\nDeferred.prototype = {\n  execute(list, args) {\n    let i = list.length;\n    // eslint-disable-next-line no-param-reassign\n    args = Array.prototype.slice.call(args);\n\n    while (i) {\n      i -= 1;\n      list[i].apply(null, args);\n    }\n  },\n  resolve(...args) {\n    this.execute(this.doneCallbacks, args);\n  },\n  reject(...args) {\n    this.execute(this.failCallbacks, args);\n  },\n  done(callback) {\n    this.doneCallbacks.push(callback);\n  },\n  fail(callback) {\n    this.failCallbacks.push(callback);\n  },\n};\n\nexport default Deferred;\n","import global from './utils/global';\nimport Deferred from './utils/deferred';\n\nlet ID = 0;\nlet YoutubeAPIadded = 0;\nlet VimeoAPIadded = 0;\nlet loadingYoutubePlayer = 0;\nlet loadingVimeoPlayer = 0;\nconst loadingYoutubeDefer = new Deferred();\nconst loadingVimeoDefer = new Deferred();\n\nclass VideoWorker {\n  constructor(url, options) {\n    const self = this;\n\n    self.url = url;\n\n    self.options_default = {\n      autoplay: false,\n      loop: false,\n      mute: false,\n      volume: 100,\n      showControls: true,\n      accessibilityHidden: false,\n\n      // start / end video time in seconds\n      startTime: 0,\n      endTime: 0,\n    };\n\n    self.options = self.extend({}, self.options_default, options);\n\n    // Fix wrong option name.\n    // Thanks to https://github.com/nk-o/video-worker/issues/13.\n    if (typeof self.options.showContols !== 'undefined') {\n      self.options.showControls = self.options.showContols;\n      delete self.options.showContols;\n    }\n\n    // check URL\n    self.videoID = self.parseURL(url);\n\n    // init\n    if (self.videoID) {\n      self.ID = ID;\n      ID += 1;\n      self.loadAPI();\n      self.init();\n    }\n  }\n\n  // Extend like jQuery.extend\n  // eslint-disable-next-line class-methods-use-this\n  extend(...args) {\n    const out = args[0] || {};\n\n    Object.keys(args).forEach((i) => {\n      if (!args[i]) {\n        return;\n      }\n      Object.keys(args[i]).forEach((key) => {\n        out[key] = args[i][key];\n      });\n    });\n\n    return out;\n  }\n\n  parseURL(url) {\n    // parse youtube ID\n    function getYoutubeID(ytUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const regExp = /.*(?:youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=)([^#\\&\\?]*).*/;\n      const match = ytUrl.match(regExp);\n      return match && match[1].length === 11 ? match[1] : false;\n    }\n\n    // parse vimeo ID\n    function getVimeoID(vmUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const regExp =\n        /https?:\\/\\/(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/([^/]*)\\/videos\\/|album\\/(\\d+)\\/video\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/;\n      const match = vmUrl.match(regExp);\n      return match && match[3] ? match[3] : false;\n    }\n\n    // parse local string\n    function getLocalVideos(locUrl) {\n      // eslint-disable-next-line no-useless-escape\n      const videoFormats = locUrl.split(/,(?=mp4\\:|webm\\:|ogv\\:|ogg\\:)/);\n      const result = {};\n      let ready = 0;\n      videoFormats.forEach((val) => {\n        // eslint-disable-next-line no-useless-escape\n        const match = val.match(/^(mp4|webm|ogv|ogg)\\:(.*)/);\n        if (match && match[1] && match[2]) {\n          // eslint-disable-next-line prefer-destructuring\n          result[match[1] === 'ogv' ? 'ogg' : match[1]] = match[2];\n          ready = 1;\n        }\n      });\n      return ready ? result : false;\n    }\n\n    const Youtube = getYoutubeID(url);\n    const Vimeo = getVimeoID(url);\n    const Local = getLocalVideos(url);\n\n    if (Youtube) {\n      this.type = 'youtube';\n      return Youtube;\n    }\n\n    if (Vimeo) {\n      this.type = 'vimeo';\n      return Vimeo;\n    }\n\n    if (Local) {\n      this.type = 'local';\n      return Local;\n    }\n\n    return false;\n  }\n\n  isValid() {\n    return !!this.videoID;\n  }\n\n  // events\n  on(name, callback) {\n    this.userEventsList = this.userEventsList || [];\n\n    // add new callback in events list\n    (this.userEventsList[name] || (this.userEventsList[name] = [])).push(callback);\n  }\n\n  off(name, callback) {\n    if (!this.userEventsList || !this.userEventsList[name]) {\n      return;\n    }\n\n    if (!callback) {\n      delete this.userEventsList[name];\n    } else {\n      this.userEventsList[name].forEach((val, key) => {\n        if (val === callback) {\n          this.userEventsList[name][key] = false;\n        }\n      });\n    }\n  }\n\n  fire(name, ...args) {\n    if (this.userEventsList && typeof this.userEventsList[name] !== 'undefined') {\n      this.userEventsList[name].forEach((val) => {\n        // call with all arguments\n        if (val) {\n          val.apply(this, args);\n        }\n      });\n    }\n  }\n\n  play(start) {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.playVideo) {\n      if (typeof start !== 'undefined') {\n        self.player.seekTo(start || 0);\n      }\n      if (global.YT.PlayerState.PLAYING !== self.player.getPlayerState()) {\n        self.player.playVideo();\n      }\n    }\n\n    if (self.type === 'vimeo') {\n      if (typeof start !== 'undefined') {\n        self.player.setCurrentTime(start);\n      }\n      self.player.getPaused().then((paused) => {\n        if (paused) {\n          self.player.play();\n        }\n      });\n    }\n\n    if (self.type === 'local') {\n      if (typeof start !== 'undefined') {\n        self.player.currentTime = start;\n      }\n      if (self.player.paused) {\n        self.player.play();\n      }\n    }\n  }\n\n  pause() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.pauseVideo) {\n      if (global.YT.PlayerState.PLAYING === self.player.getPlayerState()) {\n        self.player.pauseVideo();\n      }\n    }\n\n    if (self.type === 'vimeo') {\n      self.player.getPaused().then((paused) => {\n        if (!paused) {\n          self.player.pause();\n        }\n      });\n    }\n\n    if (self.type === 'local') {\n      if (!self.player.paused) {\n        self.player.pause();\n      }\n    }\n  }\n\n  mute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.mute) {\n      self.player.mute();\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(0);\n    }\n\n    if (self.type === 'local') {\n      self.$video.muted = true;\n    }\n  }\n\n  unmute() {\n    const self = this;\n    if (!self.player) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.mute) {\n      self.player.unMute();\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(self.options.volume);\n    }\n\n    if (self.type === 'local') {\n      self.$video.muted = false;\n    }\n  }\n\n  setVolume(volume = false) {\n    const self = this;\n    if (!self.player || !volume) {\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.setVolume) {\n      self.player.setVolume(volume);\n    }\n\n    if (self.type === 'vimeo' && self.player.setVolume) {\n      self.player.setVolume(volume);\n    }\n\n    if (self.type === 'local') {\n      self.$video.volume = volume / 100;\n    }\n  }\n\n  getVolume(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(false);\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.getVolume) {\n      callback(self.player.getVolume());\n    }\n\n    if (self.type === 'vimeo' && self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(volume);\n      });\n    }\n\n    if (self.type === 'local') {\n      callback(self.$video.volume * 100);\n    }\n  }\n\n  getMuted(callback) {\n    const self = this;\n    if (!self.player) {\n      callback(null);\n      return;\n    }\n\n    if (self.type === 'youtube' && self.player.isMuted) {\n      callback(self.player.isMuted());\n    }\n\n    if (self.type === 'vimeo' && self.player.getVolume) {\n      self.player.getVolume().then((volume) => {\n        callback(!!volume);\n      });\n    }\n\n    if (self.type === 'local') {\n      callback(self.$video.muted);\n    }\n  }\n\n  getImageURL(callback) {\n    const self = this;\n\n    if (self.videoImage) {\n      callback(self.videoImage);\n      return;\n    }\n\n    if (self.type === 'youtube') {\n      const availableSizes = ['maxresdefault', 'sddefault', 'hqdefault', '0'];\n      let step = 0;\n\n      const tempImg = new Image();\n      tempImg.onload = function () {\n        // if no thumbnail, youtube add their own image with width = 120px\n        if ((this.naturalWidth || this.width) !== 120 || step === availableSizes.length - 1) {\n          // ok\n          self.videoImage = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n          callback(self.videoImage);\n        } else {\n          // try another size\n          step += 1;\n          this.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n        }\n      };\n      tempImg.src = `https://img.youtube.com/vi/${self.videoID}/${availableSizes[step]}.jpg`;\n    }\n\n    if (self.type === 'vimeo') {\n      let request = new XMLHttpRequest();\n      // https://vimeo.com/api/oembed.json?url=https://vimeo.com/235212527\n      request.open('GET', `https://vimeo.com/api/oembed.json?url=${self.url}`, true);\n      request.onreadystatechange = function () {\n        if (this.readyState === 4) {\n          if (this.status >= 200 && this.status < 400) {\n            // Success!\n            const response = JSON.parse(this.responseText);\n\n            if (response.thumbnail_url) {\n              self.videoImage = response.thumbnail_url;\n              callback(self.videoImage);\n            }\n          } else {\n            // Error :(\n          }\n        }\n      };\n      request.send();\n      request = null;\n    }\n  }\n\n  // fallback to the old version.\n  getIframe(callback) {\n    this.getVideo(callback);\n  }\n\n  getVideo(callback) {\n    const self = this;\n\n    // return generated video block\n    if (self.$video) {\n      callback(self.$video);\n      return;\n    }\n\n    // generate new video block\n    self.onAPIready(() => {\n      let hiddenDiv;\n      if (!self.$video) {\n        hiddenDiv = document.createElement('div');\n        hiddenDiv.style.display = 'none';\n      }\n\n      // Youtube\n      if (self.type === 'youtube') {\n        self.playerOptions = {\n          // GDPR Compliance.\n          host: 'https://www.youtube-nocookie.com',\n          videoId: self.videoID,\n          playerVars: {\n            autohide: 1,\n            rel: 0,\n            autoplay: 0,\n            // autoplay enable on mobile devices\n            playsinline: 1,\n          },\n        };\n\n        // hide controls\n        if (!self.options.showControls) {\n          self.playerOptions.playerVars.iv_load_policy = 3;\n          self.playerOptions.playerVars.modestbranding = 1;\n          self.playerOptions.playerVars.controls = 0;\n          self.playerOptions.playerVars.showinfo = 0;\n          self.playerOptions.playerVars.disablekb = 1;\n        }\n\n        // events\n        let ytStarted;\n        let ytProgressInterval;\n        self.playerOptions.events = {\n          onReady(e) {\n            // mute\n            if (self.options.mute) {\n              e.target.mute();\n            } else if (self.options.volume) {\n              e.target.setVolume(self.options.volume);\n            }\n\n            // autoplay\n            if (self.options.autoplay) {\n              self.play(self.options.startTime);\n            }\n            self.fire('ready', e);\n\n            // For seamless loops, set the endTime to 0.1 seconds less than the video's duration\n            // https://github.com/nk-o/video-worker/issues/2\n            if (self.options.loop && !self.options.endTime) {\n              const secondsOffset = 0.1;\n              self.options.endTime = self.player.getDuration() - secondsOffset;\n            }\n\n            // volumechange\n            setInterval(() => {\n              self.getVolume((volume) => {\n                if (self.options.volume !== volume) {\n                  self.options.volume = volume;\n                  self.fire('volumechange', e);\n                }\n              });\n            }, 150);\n          },\n          onStateChange(e) {\n            // loop\n            if (self.options.loop && e.data === global.YT.PlayerState.ENDED) {\n              self.play(self.options.startTime);\n            }\n            if (!ytStarted && e.data === global.YT.PlayerState.PLAYING) {\n              ytStarted = 1;\n              self.fire('started', e);\n            }\n            if (e.data === global.YT.PlayerState.PLAYING) {\n              self.fire('play', e);\n            }\n            if (e.data === global.YT.PlayerState.PAUSED) {\n              self.fire('pause', e);\n            }\n            if (e.data === global.YT.PlayerState.ENDED) {\n              self.fire('ended', e);\n            }\n\n            // progress check\n            if (e.data === global.YT.PlayerState.PLAYING) {\n              ytProgressInterval = setInterval(() => {\n                self.fire('timeupdate', e);\n\n                // check for end of video and play again or stop\n                if (self.options.endTime && self.player.getCurrentTime() >= self.options.endTime) {\n                  if (self.options.loop) {\n                    self.play(self.options.startTime);\n                  } else {\n                    self.pause();\n                  }\n                }\n              }, 150);\n            } else {\n              clearInterval(ytProgressInterval);\n            }\n          },\n          onError(e) {\n            self.fire('error', e);\n          },\n        };\n\n        const firstInit = !self.$video;\n        if (firstInit) {\n          const div = document.createElement('div');\n          div.setAttribute('id', self.playerID);\n          hiddenDiv.appendChild(div);\n          document.body.appendChild(hiddenDiv);\n        }\n        self.player = self.player || new global.YT.Player(self.playerID, self.playerOptions);\n        if (firstInit) {\n          self.$video = document.getElementById(self.playerID);\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          // get video width and height\n          self.videoWidth = parseInt(self.$video.getAttribute('width'), 10) || 1280;\n          self.videoHeight = parseInt(self.$video.getAttribute('height'), 10) || 720;\n        }\n      }\n\n      // Vimeo\n      if (self.type === 'vimeo') {\n        self.playerOptions = {\n          // GDPR Compliance.\n          dnt: 1,\n          id: self.videoID,\n          autopause: 0,\n          transparent: 0,\n          autoplay: self.options.autoplay ? 1 : 0,\n          loop: self.options.loop ? 1 : 0,\n          muted: self.options.mute ? 1 : 0,\n        };\n\n        if (self.options.volume) {\n          self.playerOptions.volume = self.options.volume;\n        }\n\n        // hide controls\n        if (!self.options.showControls) {\n          self.playerOptions.badge = 0;\n          self.playerOptions.byline = 0;\n          self.playerOptions.portrait = 0;\n          self.playerOptions.title = 0;\n          self.playerOptions.background = 1;\n        }\n\n        if (!self.$video) {\n          let playerOptionsString = '';\n          Object.keys(self.playerOptions).forEach((key) => {\n            if (playerOptionsString !== '') {\n              playerOptionsString += '&';\n            }\n            playerOptionsString += `${key}=${encodeURIComponent(self.playerOptions[key])}`;\n          });\n\n          // we need to create iframe manually because when we create it using API\n          // js events won't triggers after iframe moved to another place\n          self.$video = document.createElement('iframe');\n          self.$video.setAttribute('id', self.playerID);\n          self.$video.setAttribute(\n            'src',\n            `https://player.vimeo.com/video/${self.videoID}?${playerOptionsString}`\n          );\n          self.$video.setAttribute('frameborder', '0');\n          self.$video.setAttribute('mozallowfullscreen', '');\n          self.$video.setAttribute('allowfullscreen', '');\n          self.$video.setAttribute('title', 'Vimeo video player');\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          hiddenDiv.appendChild(self.$video);\n          document.body.appendChild(hiddenDiv);\n        }\n        self.player = self.player || new global.Vimeo.Player(self.$video, self.playerOptions);\n\n        // set current time for autoplay\n        if (self.options.startTime && self.options.autoplay) {\n          self.player.setCurrentTime(self.options.startTime);\n        }\n\n        // get video width and height\n        self.player.getVideoWidth().then((width) => {\n          self.videoWidth = width || 1280;\n        });\n        self.player.getVideoHeight().then((height) => {\n          self.videoHeight = height || 720;\n        });\n\n        // events\n        let vmStarted;\n        self.player.on('timeupdate', (e) => {\n          if (!vmStarted) {\n            self.fire('started', e);\n            vmStarted = 1;\n          }\n\n          self.fire('timeupdate', e);\n\n          // check for end of video and play again or stop\n          if (self.options.endTime) {\n            if (self.options.endTime && e.seconds >= self.options.endTime) {\n              if (self.options.loop) {\n                self.play(self.options.startTime);\n              } else {\n                self.pause();\n              }\n            }\n          }\n        });\n        self.player.on('play', (e) => {\n          self.fire('play', e);\n\n          // check for the start time and start with it\n          if (self.options.startTime && e.seconds === 0) {\n            self.play(self.options.startTime);\n          }\n        });\n        self.player.on('pause', (e) => {\n          self.fire('pause', e);\n        });\n        self.player.on('ended', (e) => {\n          self.fire('ended', e);\n        });\n        self.player.on('loaded', (e) => {\n          self.fire('ready', e);\n        });\n        self.player.on('volumechange', (e) => {\n          self.fire('volumechange', e);\n        });\n        self.player.on('error', (e) => {\n          self.fire('error', e);\n        });\n      }\n\n      // Local\n      function addSourceToLocal(element, src, type) {\n        const source = document.createElement('source');\n        source.src = src;\n        source.type = type;\n        element.appendChild(source);\n      }\n      if (self.type === 'local') {\n        if (!self.$video) {\n          self.$video = document.createElement('video');\n\n          // show controls\n          if (self.options.showControls) {\n            self.$video.controls = true;\n          }\n\n          // mute\n          if (self.options.mute) {\n            self.$video.muted = true;\n          } else if (self.$video.volume) {\n            self.$video.volume = self.options.volume / 100;\n          }\n\n          // loop\n          if (self.options.loop) {\n            self.$video.loop = true;\n          }\n\n          // autoplay enable on mobile devices\n          self.$video.setAttribute('playsinline', '');\n          self.$video.setAttribute('webkit-playsinline', '');\n\n          // add accessibility attributes\n          if (self.options.accessibilityHidden) {\n            self.$video.setAttribute('tabindex', '-1');\n            self.$video.setAttribute('aria-hidden', 'true');\n          }\n\n          self.$video.setAttribute('id', self.playerID);\n          hiddenDiv.appendChild(self.$video);\n          document.body.appendChild(hiddenDiv);\n\n          Object.keys(self.videoID).forEach((key) => {\n            addSourceToLocal(self.$video, self.videoID[key], `video/${key}`);\n          });\n        }\n\n        self.player = self.player || self.$video;\n\n        let locStarted;\n        self.player.addEventListener('playing', (e) => {\n          if (!locStarted) {\n            self.fire('started', e);\n          }\n          locStarted = 1;\n        });\n        self.player.addEventListener('timeupdate', function (e) {\n          self.fire('timeupdate', e);\n\n          // check for end of video and play again or stop\n          if (self.options.endTime) {\n            if (self.options.endTime && this.currentTime >= self.options.endTime) {\n              if (self.options.loop) {\n                self.play(self.options.startTime);\n              } else {\n                self.pause();\n              }\n            }\n          }\n        });\n        self.player.addEventListener('play', (e) => {\n          self.fire('play', e);\n        });\n        self.player.addEventListener('pause', (e) => {\n          self.fire('pause', e);\n        });\n        self.player.addEventListener('ended', (e) => {\n          self.fire('ended', e);\n        });\n        self.player.addEventListener('loadedmetadata', function () {\n          // get video width and height\n          self.videoWidth = this.videoWidth || 1280;\n          self.videoHeight = this.videoHeight || 720;\n\n          self.fire('ready');\n\n          // autoplay\n          if (self.options.autoplay) {\n            self.play(self.options.startTime);\n          }\n        });\n        self.player.addEventListener('volumechange', (e) => {\n          self.getVolume((volume) => {\n            self.options.volume = volume;\n          });\n          self.fire('volumechange', e);\n        });\n        self.player.addEventListener('error', (e) => {\n          self.fire('error', e);\n        });\n      }\n      callback(self.$video);\n    });\n  }\n\n  init() {\n    const self = this;\n\n    self.playerID = `VideoWorker-${self.ID}`;\n  }\n\n  loadAPI() {\n    const self = this;\n\n    if (YoutubeAPIadded && VimeoAPIadded) {\n      return;\n    }\n\n    let src = '';\n\n    // load Youtube API\n    if (self.type === 'youtube' && !YoutubeAPIadded) {\n      YoutubeAPIadded = 1;\n      src = 'https://www.youtube.com/iframe_api';\n    }\n\n    // load Vimeo API\n    if (self.type === 'vimeo' && !VimeoAPIadded) {\n      VimeoAPIadded = 1;\n\n      // Useful when Vimeo API added using RequireJS https://github.com/nk-o/video-worker/pull/7\n      if (typeof global.Vimeo !== 'undefined') {\n        return;\n      }\n\n      src = 'https://player.vimeo.com/api/player.js';\n    }\n\n    if (!src) {\n      return;\n    }\n\n    // add script in head section\n    let tag = document.createElement('script');\n    let head = document.getElementsByTagName('head')[0];\n    tag.src = src;\n\n    head.appendChild(tag);\n\n    head = null;\n    tag = null;\n  }\n\n  onAPIready(callback) {\n    const self = this;\n\n    // Youtube\n    if (self.type === 'youtube') {\n      // Listen for global YT player callback\n      if ((typeof global.YT === 'undefined' || global.YT.loaded === 0) && !loadingYoutubePlayer) {\n        // Prevents Ready event from being called twice\n        loadingYoutubePlayer = 1;\n\n        // Creates deferred so, other players know when to wait.\n        global.onYouTubeIframeAPIReady = function () {\n          global.onYouTubeIframeAPIReady = null;\n          loadingYoutubeDefer.resolve('done');\n          callback();\n        };\n      } else if (typeof global.YT === 'object' && global.YT.loaded === 1) {\n        callback();\n      } else {\n        loadingYoutubeDefer.done(() => {\n          callback();\n        });\n      }\n    }\n\n    // Vimeo\n    if (self.type === 'vimeo') {\n      if (typeof global.Vimeo === 'undefined' && !loadingVimeoPlayer) {\n        loadingVimeoPlayer = 1;\n        const vimeoInterval = setInterval(() => {\n          if (typeof global.Vimeo !== 'undefined') {\n            clearInterval(vimeoInterval);\n            loadingVimeoDefer.resolve('done');\n            callback();\n          }\n        }, 20);\n      } else if (typeof global.Vimeo !== 'undefined') {\n        callback();\n      } else {\n        loadingVimeoDefer.done(() => {\n          callback();\n        });\n      }\n    }\n\n    // Local\n    if (self.type === 'local') {\n      callback();\n    }\n  }\n}\n\nexport default VideoWorker;\n"],"names":["win","window","global","self","Deferred","doneCallbacks","failCallbacks","prototype","execute","list","args","i","length","Array","slice","call","apply","resolve","reject","done","callback","push","fail","ID","YoutubeAPIadded","VimeoAPIadded","loadingYoutubePlayer","loadingVimeoPlayer","loadingYoutubeDefer","loadingVimeoDefer","VideoWorker","constructor","url","options","options_default","autoplay","loop","mute","volume","showControls","accessibilityHidden","startTime","endTime","extend","showContols","videoID","parseURL","loadAPI","init","out","Object","keys","forEach","key","getYoutubeID","ytUrl","regExp","match","getVimeoID","vmUrl","getLocalVideos","locUrl","videoFormats","split","result","ready","val","Youtube","Vimeo","Local","type","isValid","on","name","userEventsList","off","fire","play","start","player","playVideo","seekTo","YT","PlayerState","PLAYING","getPlayerState","setCurrentTime","getPaused","then","paused","currentTime","pause","pauseVideo","setVolume","$video","muted","unmute","unMute","getVolume","getMuted","isMuted","getImageURL","videoImage","availableSizes","step","tempImg","Image","onload","naturalWidth","width","src","request","XMLHttpRequest","open","onreadystatechange","readyState","status","response","JSON","parse","responseText","thumbnail_url","send","getIframe","getVideo","onAPIready","hiddenDiv","document","createElement","style","display","playerOptions","host","videoId","playerVars","autohide","rel","playsinline","iv_load_policy","modestbranding","controls","showinfo","disablekb","ytStarted","ytProgressInterval","events","onReady","e","target","secondsOffset","getDuration","setInterval","onStateChange","data","ENDED","PAUSED","getCurrentTime","clearInterval","onError","firstInit","div","setAttribute","playerID","appendChild","body","Player","getElementById","videoWidth","parseInt","getAttribute","videoHeight","dnt","id","autopause","transparent","badge","byline","portrait","title","background","playerOptionsString","encodeURIComponent","getVideoWidth","getVideoHeight","height","vmStarted","seconds","addSourceToLocal","element","source","locStarted","addEventListener","tag","head","getElementsByTagName","loaded","onYouTubeIframeAPIReady","vimeoInterval"],"mappings":"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"}